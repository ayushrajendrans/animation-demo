/*! For license information please see core.min.js.LICENSE.txt */
var _interactive_gallery_core;this.IG=this.IG||{},(()=>{var e={609:(e,t,n)=>{var i=n(425).default;function r(){"use strict";e.exports=r=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,o=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},l=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function h(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(e){h=function(e,t,n){return e[t]=n}}function p(e,t,n,i){var r=t&&t.prototype instanceof m?t:m,o=Object.create(r.prototype),s=new C(i||[]);return a(o,"_invoke",{value:_(e,n,s)}),o}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=p;var f={};function m(){}function v(){}function g(){}var y={};h(y,l,(function(){return this}));var b=Object.getPrototypeOf,w=b&&b(b(j([])));w&&w!==n&&o.call(w,l)&&(y=w);var k=g.prototype=m.prototype=Object.create(y);function x(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function n(r,a,s,l){var c=d(e[r],e,a);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==i(h)&&o.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,s,l)}),(function(e){n("throw",e,s,l)})):t.resolve(h).then((function(e){u.value=e,s(u)}),(function(e){return n("throw",e,s,l)}))}l(c.arg)}var r;a(this,"_invoke",{value:function(e,i){function o(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(o,o):o()}})}function _(e,t,n){var i="suspendedStart";return function(r,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw o;return{value:void 0,done:!0}}for(n.method=r,n.arg=o;;){var a=n.delegate;if(a){var s=T(a,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var l=d(e,t,n);if("normal"===l.type){if(i=n.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i="completed",n.method="throw",n.arg=l.arg)}}}function T(e,t){var n=t.method,i=e.iterator[n];if(void 0===i)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,T(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var r=d(i,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,f;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function j(e){if(e){var t=e[l];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(o.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return v.prototype=g,a(k,"constructor",{value:g,configurable:!0}),a(g,"constructor",{value:v,configurable:!0}),v.displayName=h(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,h(e,u,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},x(P.prototype),h(P.prototype,c,(function(){return this})),t.AsyncIterator=P,t.async=function(e,n,i,r,o){void 0===o&&(o=Promise);var a=new P(p(e,n,i,r),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(k),h(k,u,"Generator"),h(k,l,(function(){return this})),h(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},t.values=j,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(M),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,i){return a.type="throw",a.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],a=r.completion;if("root"===r.tryLoc)return n("end");if(r.tryLoc<=this.prev){var s=o.call(r,"catchLoc"),l=o.call(r,"finallyLoc");if(s&&l){if(this.prev<r.catchLoc)return n(r.catchLoc,!0);if(this.prev<r.finallyLoc)return n(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return n(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return n(r.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&o.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),M(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;M(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:j(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},425:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},841:(e,t,n)=>{var i=n(609)();e.exports=i;try{regeneratorRuntime=i}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};(()=>{"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function r(e){var n=function(e,n){if("object"!==t(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,"string");if("object"!==t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===t(n)?n:String(n)}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,r(i.key),i)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}function u(e,n){if(n&&("object"===t(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}n.r(i),n.d(i,{App:()=>gt,CustomRenderer:()=>He,Gallery:()=>et,Tweaks:()=>oe});const p=IG.vendors;var d="change",f="complete",m="click",v="face:changing",g="filedrop",y="key_down",b="load",w="loaded",k="mousedown",x="mousemove",P="mouseup",_="progress",T="ready",R="resize",M="rotation:started",C="rotation:ended",j="touchstart",S="touchmove",E="touchend",O="tweaks:presets",L="tweaks:debug";const I=function(e){return new Promise((function(t){!function n(){e.offsetHeight>0&&e.offsetWidth>0?t():self.requestAnimationFrame(n)}()}))};var A=new RegExp(/\$\{assetPath\}/gi),D={debug:(0,p.isDef)(window.IG.debug)&&-1!==location.hash.indexOf("#debug"),touch:!1,assets:null,pixelRatio:Math.min(Math.max(devicePixelRatio,1.5),2),init:function(e){this.emulateHash="?emulateMobile",this.emulateMobile=this.debug&&-1!==location.hash.indexOf(this.emulateHash),this.assetsPath=e.assetsPath,this.decodersPath=e.decodersPath,this.assets=e.assets,this.watchfaces=e.watchfaces},fetch:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){var e=this;return fetch(e.fixAssetPath(e.assets)).then((function(e){return e.text()})).then((function(t){return JSON.parse(e.fixAssetPath(t))})).then((function(t){return e.assets=t}))})),fixAssetPath:function(e){return e.replace(A,this.assetsPath)},getDecoderPath:function(e){return this.decodersPath+"/"+e+"/"}};(0,p.listen)(window,1,"touchstart",(function(){return D.touch=!0}),{once:!0});const F=D;var z=new(function(t){c(o,t);var n,i,r=(n=o,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(n);if(i){var r=h(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return u(this,e)});function o(){var t;return e(this,o),(t=r.call(this)).bPending=!1,t}return a(o,[{key:"init",value:function(e){var t=this,n=!1,i=function i(){var r=function(){var t=window.innerWidth,n=window.innerHeight;return e&&(t=e.offsetWidth,n=e.offsetHeight),{width:t,height:n}}(),o=r.width,a=r.height;0!==o&&0!==a?(t.width=o,t.height=a,t.isMobileSize=o<1024,t.orientation=matchMedia("only screen and (min-width: 64em)").matches?$:U,t.trigger(R)):n||(n=!0,I(e).then((function(){n=!1,i()})))};(0,p.listen)(window,!0,R,i),i()}}]),o}(p.EventEmitter)),U="portrait",$="landscape";const V=z;var B=function(t){c(o,t);var n,i,r=(n=o,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(n);if(i){var r=h(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return u(this,e)});function o(){var t;return e(this,o),(t=r.call(this)).start=Date.now(),t.current=t.start,t.elapsed=0,t.delta=16,t.playing=!0,t.tick=t.tick.bind(s(t)),t.tick(),t}return a(o,[{key:"play",value:function(){this.playing=!0}},{key:"pause",value:function(){this.playing=!1}},{key:"tick",value:function(){this.ticker=requestAnimationFrame(this.tick);var e=Date.now();this.delta=e-this.current,this.elapsed+=this.playing?this.delta:0,this.current=e,this.delta>60&&(this.delta=60),this.playing&&this.trigger("tick")}},{key:"stop",value:function(){cancelAnimationFrame(this.ticker)}}]),o}(p.EventEmitter);function G(e,t){var n=e.length;if(!(n<=0||"function"!=typeof t))for(var i=0;i<n;i++)t(e[i],i,e)}var N=function(t){c(o,t);var n,i,r=(n=o,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(n);if(i){var r=h(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return u(this,e)});function o(t){var n;return e(this,o),(n=r.call(this)).target=t,n._initTarget(),n}return a(o,[{key:"_initTarget",value:function(){var e=this;this.target.addEventListener("drop",(function(t){e._dropHandler(t)})),this.target.addEventListener("dragover",(function(t){e._dragOverHandler(t)}))}},{key:"_dragOverHandler",value:function(e){e.preventDefault(),this.target.classList.add("js-drop-asset--over")}},{key:"_dropHandler",value:function(e){e.preventDefault(),this.target.classList.remove("js-drop-asset--over");var t=[];e.dataTransfer.items?G(e.dataTransfer.items,(function(e){"file"===e.kind&&t.push(e.getAsFile())})):G(e.dataTransfer.files,(function(e){t.push(file)})),this.trigger(g,[t])}}]),o}(p.EventEmitter);function Y(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}var H=n(841),X=n.n(H);const W=IG.debug;var Z="boolean",q="button",J="choice",K="color",Q="number",ee="text",te="value";function ne(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ie(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var re=null,oe=function(n){c(f,n);var i,r,o,s,l=(o=f,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(o);if(s){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return u(this,e)});function f(){var t;return e(this,f),(t=l.call(this)).presets=null,t.items=[],t.folders=[],t}return a(f,[{key:"setDebug",value:function(e){var t=this;this.debug=e,this.debug.registerPlugin(W.TextareaPlugin),this.getTweak({path:"presets",preset:!1,type:q,title:"import presets.json",onClick:function(){t.importPresets()}}),this.getTweak({path:"presets",preset:!1,type:q,title:"export presets.json",onClick:function(){t.exportPresets()}}),this.getTweak({path:"presets",preset:!1,type:q,title:"copy to clipboard",onClick:function(){t.copyPresets()}}),(0,p.listen)(window,!0,y,(function(e){"KeyS"===e.code&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),t.exportPresets())})),this.trigger(L)}},{key:"loadPresets",value:(i=X().mark((function e(t){var n,i;return X().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.json();case 5:i=e.sent,this.presets=i,this.trigger(O,[i]);case 8:case"end":return e.stop()}}),e,this)})),r=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){Y(o,n,r,a,s,"next",e)}function s(e){Y(o,n,r,a,s,"throw",e)}a(void 0)}))},function(e){return r.apply(this,arguments)})},{key:"importPresets",value:function(){var e=this,t=document.createElement("input");t.type="file",t.accept=".json",t.addEventListener(d,(function(t){var n=t.target.files[0],i=new FileReader;i.readAsText(n),i.addEventListener(b,(function(t){var n;try{n=JSON.parse(t.target.result)}catch(e){return console.log(e),void alert("Cannot read json file")}e.applyPresets(n)}))})),t.click()}},{key:"applyPresets",value:function(e){var n=this;!function e(i,r){var o=function(){var o=r[a];if("object"===t(o))e("".concat(i,".").concat(a),o);else{var s=i.substring(1),l=a,c=n.items.find((function(e){return e.path.replace(/^presets\./,"")===s&&e.presetProperty===l}));c&&(c.value=o,c.apply(c),c.input.refresh())}};for(var a in r)o()}("",e),this.presets=e,this.trigger("presetsApplied")}},{key:"getFormatedPresets",value:function(){var e,t={},n=ne(this.items);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(i.preset){var r,o=i.path.replace(/^presets\./,"").split("."),a=t,s=ne(o);try{for(s.s();!(r=s.n()).done;){var l=r.value,c=a[l];c||(c={},a[l]=c),a=c}}catch(e){s.e(e)}finally{s.f()}a[i.presetProperty]=i.value}}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"exportPresets",value:function(){var e=this.getFormatedPresets(),t=JSON.stringify(e,null,"    "),n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download","presets.json"),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}},{key:"copyPresets",value:function(){var e=this;navigator.permissions.query({name:"clipboard-write"}).then((function(t){if("granted"===t.state||"prompt"===t.state){var n=e.getFormatedPresets(),i=JSON.stringify(n,null,"    ");navigator.clipboard.writeText(i).then((function(){}),(function(){alert("copy to clipboard failed")}))}}))}},{key:"getTweak",value:function(e){var t=e.presetProperty?e.presetProperty:e.objectProperty,n=function(){return e.type===ee&&e.lineCount&&e.lineCount>1},i={};if(i.type=e.type,i.path=e.path,i.preset=void 0===e.preset||!!e.preset,i.presetProperty=t,i.default=e.default,i.value=this.getPresetValue(i.path,i.presetProperty,i.default),Object.defineProperty(i,"error",{set:function(e){this.input&&(this.input.controller_.view.valueElement.children[0].children[0].style.color=e?"#ff5555":"")}}),i.type!==q&&e.object&&e.objectProperty&&(i.object=e.object,i.objectProperty=e.objectProperty,i.onChange="function"==typeof e.onChange?e.onChange:null,e.apply?i.apply=e.apply:i.apply=function(e){e.object[e.objectProperty]=e.value},i.apply(i)),this.debug){switch(i.folder=this.getFolder(i.path),i.type){case Q:i.input=i.folder.debug.addInput(i,te,{label:i.presetProperty,min:e.min,max:e.max,step:e.step});break;case Z:case K:i.input=i.folder.debug.addInput(i,te,{label:i.presetProperty});break;case J:i.input=i.folder.debug.addInput(i,te,{label:i.presetProperty,view:"list",options:e.options});break;case ee:n()?i.input=i.folder.debug.addInput(i,te,{view:"textarea",label:i.presetProperty,lineCount:e.lineCount}):i.input=i.folder.debug.addInput(i,te,{label:i.presetProperty});break;case q:i.input=i.folder.debug.addButton({title:e.title}),"function"==typeof e.onClick&&i.input.on("click",e.onClick)}if(i.input.disabled=e.disable,i.type!==q){var r=i.value;i.input.on(d,(function(){!n()&&i.apply&&i.apply(i),"function"==typeof i.onChange&&(n()?(clearTimeout(re),re=setTimeout((function(){i.onChange(i,r)}),1500)):i.onChange(i,r),r=i.value)}))}}return this.items.push(i),i}},{key:"getPresetValue",value:function(e,t,n){var i,r=e.replace(/^presets\./,"").split("."),o=this.presets,a=ne(r);try{for(a.s();!(i=a.n()).done;)if(!(o=o[i.value]))return n}catch(e){a.e(e)}finally{a.f()}return void 0!==o[t]?o[t]:n}},{key:"getFolder",value:function(e){var t,n=this,i=e.split("."),r=[],o=this,a=o,s=ne(i);try{var l=function(){var e=t.value;r.push(e);var i=r.join(".");(a=n.folders.find((function(e){return e.path===i})))||((a={}).path=i,a.debug=o.debug.addFolder({title:e,expanded:!1}),n.folders.push(a)),o=a};for(s.s();!(t=s.n()).done;)l()}catch(e){s.e(e)}finally{s.f()}return a}},{key:"deleteFolder",value:function(e){var t,n=ne(this.items.filter((function(t){return t.path.startsWith(e)})));try{for(n.s();!(t=n.n()).done;){var i=t.value;this.debug&&i.input.dispose();var r=this.items.indexOf(i);this.items.splice(r,1)}}catch(e){n.e(e)}finally{n.f()}var o,a=ne(this.folders.filter((function(t){return t.path.startsWith(e)})));try{for(a.s();!(o=a.n()).done;){var s=o.value;this.debug&&s.debug.dispose();var l=this.folders.indexOf(s);this.folders.splice(l,1)}}catch(e){a.e(e)}finally{a.f()}}},{key:"updatePath",value:function(e,t){var n,i=new RegExp("^".concat(e)),r=ne(this.items);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.path.match(i)&&(o.path=o.path.replace(i,t))}}catch(e){r.e(e)}finally{r.f()}var a,s=ne(this.folders);try{for(s.s();!(a=s.n()).done;){var l=a.value;l.path.match(i)&&(l.path=l.path.replace(i,t))}}catch(e){s.e(e)}finally{s.f()}}}]),f}(p.EventEmitter),ae=function(){function t(n){e(this,t),this.active=!1,this.instance=n.baseInstance.clone(),this.instance.position.set(.5,.25,1.5),this.instance.position.multiplyScalar(1.35),this.orbitControls=new p.OrbitControls(this.instance,n.$target),this.orbitControls.enabled=this.active,this.orbitControls.screenSpacePanning=!0,this.orbitControls.enableKeys=!1,this.orbitControls.zoomSpeed=.25,this.orbitControls.enableDamping=!0,this.orbitControls.update()}return a(t,[{key:"update",value:function(){this.active&&this.orbitControls.update()}},{key:"activate",value:function(){this.active=!0,this.orbitControls.enabled=!0}},{key:"deactivate",value:function(){this.active=!1,this.orbitControls.enabled=!1}},{key:"destroy",value:function(){this.orbitControls.dispose()}}]),t}(),se=function(){function t(n){e(this,t),this.active=!1,this.instance=n.baseInstance.clone(),this.instance.rotation.reorder("YXZ")}return a(t,[{key:"activate",value:function(){this.active=!0}},{key:"deactivate",value:function(){this.active=!1}},{key:"destroy",value:function(){}}]),t}(),le="defaultCamera",ce="debugCamera",ue=function(){function t(n){var i=this;e(this,t),this.time=n.time,this.$target=n.$target,this.scene=n.scene,this.mode=le,n.tweaks.getTweak({path:"others.camera",preset:!1,object:this,objectProperty:"mode",presetProperty:"mode",type:J,default:this.mode,options:[{text:"default",value:le},{text:"debug",value:ce}],onChange:function(){i.mode===le?(i.defaultCamera.activate(),i.debugCamera.deactivate()):i.mode===ce&&(i.defaultCamera.deactivate(),i.debugCamera.activate())}}),this._setInstance(),this._setDefaultCamera(),this._setDebugCamera(),this[this.mode].activate()}return a(t,[{key:"resize",value:function(){this.instance.aspect=V.width/V.height,this.instance.updateProjectionMatrix()}},{key:"update",value:function(){this.debugCamera.update(),this.instance.position.copy(this[this.mode].instance.position),this.instance.quaternion.copy(this[this.mode].instance.quaternion),this.instance.updateMatrixWorld()}},{key:"destroy",value:function(){this.defaultCamera.destroy(),this.debugCamera.destroy()}},{key:"_setInstance",value:function(){this.instance=new p.Three.PerspectiveCamera(25,V.width/V.height,.1,150),this.instance.rotation.reorder("YXZ"),this.scene.add(this.instance)}},{key:"_setDefaultCamera",value:function(){this.defaultCamera=new se({time:this.time,baseInstance:this.instance,$target:this.$target})}},{key:"_setDebugCamera",value:function(){this.debugCamera=new ae({baseInstance:this.instance,$target:this.$target}),this.mode===ce&&this.debugCamera.activate()}}]),t}();const he=function(){function t(n){e(this,t),this.camera=n.camera,this.renderer=n.renderer,this.enabled=!1,this.renderer.postProcess.bokehPass.enabled=this.enabled}return a(t,[{key:"activate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.04,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;this.activated||(this.enabled=!0,this.renderer.postProcess.bokehPass.enabled=!0,V.orientation===$&&(this.renderer.postProcess.composer.setPixelRatio(1),this.renderer.instance.setPixelRatio(1))),p.gsap.killTweensOf(this.renderer.postProcess.bokehPass.uniforms.aperture),p.gsap.to(this.renderer.postProcess.bokehPass.uniforms.aperture,{duration:i,ease:"power3.in",value:t}),p.gsap.killTweensOf(this.renderer.postProcess.bokehPass.uniforms.maxblur),p.gsap.to(this.renderer.postProcess.bokehPass.uniforms.maxblur,{duration:i,ease:"power3.in",value:n}),p.gsap.killTweensOf(this.renderer.postProcess.bokehPass.uniforms.focus),p.gsap.to(this.renderer.postProcess.bokehPass.uniforms.focus,{duration:i,ease:"power3.in",value:e}),this.focus=e,this.activated=!0}},{key:"deactivate",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;this.activated&&(p.gsap.killTweensOf(this.renderer.postProcess.bokehPass.uniforms.aperture),p.gsap.to(this.renderer.postProcess.bokehPass.uniforms.aperture,{duration:t,ease:"power3.out",value:0,onComplete:function(){e.enabled=!1,e.renderer.postProcess.bokehPass.enabled=!1,V.orientation===$&&(e.renderer.postProcess.composer.setPixelRatio(F.pixelRatio),e.renderer.instance.setPixelRatio(F.pixelRatio)),e.renderer.update()}}),this.activated=!1)}},{key:"update",value:function(){if(this.enabled&&"debugCamera"===this.camera.mode){var e=this.camera.defaultCamera.instance.position.clone(),t=new p.Three.Vector3;this.camera.defaultCamera.instance.getWorldDirection(t),t.setLength(this.focus),e.add(t);var n=e.distanceTo(this.camera.debugCamera.instance.position);this.renderer.postProcess.bokehPass.uniforms.focus.value=n}}}]),t}();const pe=function(t){c(o,t);var n,i,r=(n=o,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(n);if(i){var r=h(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return u(this,e)});function o(t){var n;return e(this,o),(n=r.call(this)).camera=t.camera,n.visible=!0,n.active=!0,n.object=new p.Three.Object3D,n.object.position.set(0,0,.38),t.scene.add(n.object),n.groups={},n.groups.base={ratio:.1,progress:0},n.groups.final={ratio:.9,progress:0},n.screenPosition={},n.screenPosition.normalized=new p.Three.Vector2,n.screenPosition.style={x:0,y:0},t.resources.on(_,(function(e){n.groups[e.name].progress=e.loaded/e.toLoad;var t=0;for(var i in n.groups){var r=n.groups[i];t+=r.progress*r.ratio}n.trigger(_,[t])})),n}return a(o,[{key:"update",value:function(){if(this.active){var e=new p.Three.Vector3;e.applyMatrix4(this.object.matrixWorld);var t=new p.Three.Vector3;t.copy(e),t.project(this.camera.instance),this.screenPosition.normalized.x=t.x,this.screenPosition.normalized.y=t.y,this.visible=t.x>-1&&t.x<1&&t.y>-1&&t.y<1,this.screenPosition.style.x=t.x*V.width*.5+.5*V.width,this.screenPosition.style.x=Math.round(4*this.screenPosition.style.x)/4,this.screenPosition.style.y=-t.y*V.height*.5+.5*V.height,this.screenPosition.style.y=Math.round(4*this.screenPosition.style.y)/4}else this.visible=!1}}]),o}(p.EventEmitter);function de(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fe=function(){function t(){e(this,t),this.x=.5*V.width,this.y=.5*V.height,this.normalized={},this.normalized.x=0,this.normalized.y=0,!V.isMobileSize&&!F.emulateMobile&&this.setMouse()}return a(t,[{key:"setMouse",value:function(){var e=this;this.mouse={},this.mouse.events={},this.mouse.events.mouseMove=function(t){e.move(t.clientX,t.clientY)},(0,p.listen)(document,!0,x,this.mouse.events.mouseMove)}},{key:"move",value:function(e,t){this.x=e,this.y=t}},{key:"update",value:function(){var e=V.width,t=V.height;this.normalized.x=this.x/e-.5,this.normalized.y=-(this.y/t-.5),e<t?this.normalized.y*=t/e:this.normalized.x*=e/t}},{key:"destroy",value:function(){(0,p.listen)(document,!1,x,this.mouse.events.mouseMove)}}]),t}();var me="down",ve="start";const ge=function(t){c(o,t);var n,i,r=(n=o,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(n);if(i){var r=h(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return u(this,e)});function o(t){var n;return e(this,o),(n=r.call(this)).$target=t,n.active=!1,n.button=null,n.isDown=!1,n.isStarted=!1,n.prevent=!1,n.start={},n.start.x=0,n.start.y=0,n.current={},n.current.x=0,n.current.y=0,n.previous={},n.previous.x=0,n.previous.y=0,n.pooledDelta={},n.pooledDelta.x=0,n.pooledDelta.y=0,n.delta={},n.delta.x=0,n.delta.y=0,n.delta.normalized={},n.delta.normalized.x=0,n.delta.normalized.y=0,n.distanceFromStart=0,n.setMouse(),n.setTouch(),n}return a(o,[{key:"setMouse",value:function(){var e=this;this.mouse={},this.mouse.events={},this.mouse.events.mouseDown=function(t){if(e.active){if(0===t.button)e.button="left";else{if(2!==t.button)return void(e.button=null);e.button="right"}e.down(t.clientX,t.clientY),(0,p.listen)(document,!0,x,e.mouse.events.mouseMove),(0,p.listen)(document,!0,P,e.mouse.events.mouseUp)}},this.mouse.events.mouseMove=function(t){e.active&&e.move(t.clientX,t.clientY)},this.mouse.events.mouseUp=function(){e.up(),e.button=null,(0,p.listen)(document,!1,x,e.mouse.events.mouseMove),(0,p.listen)(document,!1,P,e.mouse.events.mouseUp)},(0,p.listen)(this.$target,!0,k,this.mouse.events.mouseDown)}},{key:"setTouch",value:function(){var e=this;this.touch={},this.touch.events={},this.touch.active=!1,this.touch.events.touchStart=function(t){e.active&&e.touch.active&&(e.down(t.touches[0].clientX,t.touches[0].clientY),(0,p.listen)(document,!0,S,e.touch.events.touchMove),(0,p.listen)(document,!0,E,e.touch.events.touchEnd))},this.touch.events.touchMove=function(t){e.active&&e.touch.active&&(t.touches.length>1||(e.prevent&&t.preventDefault(),e.move(t.touches[0].clientX,t.touches[0].clientY)))},this.touch.events.touchEnd=function(){e.up(),(0,p.listen)(document,!1,S,e.touch.events.touchMove),(0,p.listen)(document,!1,E,e.touch.events.touchEnd)},(0,p.listen)(this.$target,!0,j,this.touch.events.touchStart)}},{key:"down",value:function(e,t){this.start.x=e,this.start.y=t,this.current.x=e,this.current.y=t,this.previous.x=e,this.previous.y=t,this.isDown=!0,this.isStarted=!1,this.trigger(me)}},{key:"move",value:function(e,t){this.previous.x=this.current.x,this.previous.y=this.current.y,this.pooledDelta.x+=e-this.current.x,this.pooledDelta.y+=t-this.current.y,this.current.x=e,this.current.y=t,this.distanceFromStart=Math.hypot(this.current.x-this.start.x,this.current.y-this.start.y),!this.isStarted&&this.distanceFromStart>10&&(this.trigger(ve),this.isStarted=!0),this.isStarted&&this.trigger("move")}},{key:"up",value:function(){this.isDown=!1,this.trigger("up"),this.isStarted&&this.trigger("end")}},{key:"update",value:function(){if(this.isStarted){this.delta.x=this.pooledDelta.x,this.delta.y=this.pooledDelta.y;var e=Math.min(V.width,V.height);this.delta.normalized.x=this.delta.x/e,this.delta.normalized.y=this.delta.y/e,this.pooledDelta.x=0,this.pooledDelta.y=0}}},{key:"destroy",value:function(){(0,p.listen)(document,!1,x,this.mouse.events.mouseMove),(0,p.listen)(document,!1,P,this.mouse.events.mouseUp),(0,p.listen)(this.$target,!1,k,this.mouse.events.mouseDown),(0,p.listen)(document,!1,S,this.touch.events.touchMove),(0,p.listen)(document,!1,E,this.touch.events.touchEnd),(0,p.listen)(this.$target,!1,j,this.touch.events.touchStart)}}]),o}(p.EventEmitter);function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){de(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const we=function(t){c(o,t);var n,i,r=(n=o,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(n);if(i){var r=h(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return u(this,e)});function o(t){var n;return e(this,o),(n=r.call(this)).$target=t.$target,n.tweaks=t.tweaks,n.camera=t.camera.defaultCamera.instance,n.time=t.time,n.world=t.world,n.scene=t.scene,n.depthOfField=t.depthOfField,n.cursorPositionControls=new fe(t),n.dragControls=new ge(t.$target),n.dragControls.touch.active=!0,n.tweens={},n.view=n._buildView(),n.orbitControls=n._buildOrbitControls(),n.view.leave(0),n}return a(o,[{key:"start",value:function(){var e=this;this.tweens.points=p.gsap.delayedCall(2.5,(function(){e.world.points.canBeVisible=!0}));var t=this.world.model.faces;t&&t.items.size>1&&t.items.forEach((function(t,n){e.tweaks.getTweak({path:"others.faces",preset:!1,type:q,title:"goFace('".concat(n,"')"),onClick:function(){e.goFace(n)}})}))}},{key:"reveal",value:function(){var e=this;this.orbitControls.activate(),this.tweens.orbitDelay=p.gsap.delayedCall(1.25,(function(){e.world.orbit.show()}))}},{key:"goFace",value:function(e){var t=this;if(!this.world.model.faces.current||e!==this.world.model.faces.current.name){var n=this.world.model.faces.current?this.world.model.faces.current.index:-1,i=this.world.model.faces.items.get(e).index>n;this.tweens.facesDelay&&this.tweens.facesDelay.kill(),this.tweens.modelFlip&&this.tweens.modelFlip.kill(),this.tweens.modelFlip=this.world.model.rotation.flip(i,1.5),this.tweens.facesDelay=p.gsap.delayedCall(.75,(function(){t.world.model.faces.change(e)})),this.trigger(v,[e])}}},{key:"goPoint",value:function(e){var t=this.tweens,n=this.world,i=n.points.animations;t.environmentAmplitude&&t.environmentAmplitude.kill(),t.environmentRotation&&t.environmentRotation.kill(),t.modelFlip&&t.modelFlip.kill(),t.modelOffset&&t.modelOffset.kill(),this.view.go(e,i.in.duration,i.ease),this.orbitControls.deactivate(i.duration,i.ease),n.orbit.hide(),n.points.canBeVisible=!1}},{key:"leavePoint",value:function(){var e=this.tweens,t=this.world,n=t.points.animations;e.points&&e.points.kill(),e.environmentAmplitude&&e.environmentAmplitude.kill(),e.environmentRotation&&e.environmentRotation.kill(),e.modelOffset&&e.modelOffset.kill(),this.orbitControls.activate(n.out.duration,n.out.ease),t.orbit.shouldShow&&(e.orbitDelay=p.gsap.delayedCall(.5*n.out.duration,(function(){t.orbit.show()}))),this.view.leave(n.out.duration,n.out.ease),e.points=p.gsap.delayedCall(.8*n.out.duration,(function(){t.points.canBeVisible=!0}))}},{key:"resize",value:function(){if(this.orbitControls.base.radius=2.6+1.75*Math.max(V.height/V.width-1,0),this.orbitControls.spherical.radius=this.orbitControls.base.radius,this.view.coordinates.current){var e=be({},this.view.coordinates.current.position);this.view.position.copy(e)}}},{key:"update",value:function(){var e=this.camera,t=this.orbitControls,n=this.dragControls;this.cursorPositionControls.update(),n.update(),t.target.theta-=n.delta.normalized.x*t.multiplier,t.target.phi-=n.delta.normalized.y*t.multiplier,t.target.phi=Math.min(Math.max(t.target.phi,t.limits.phi.min),t.limits.phi.max);var i=t.target.phi-t.spherical.phi,r=t.target.theta-t.spherical.theta;t.speed.phi+=i*(n.isDown?t.traction.active:t.traction.inactive),t.speed.theta+=r*(n.isDown?t.traction.active:t.traction.inactive),t.speed.phi*=1-(n.isDown?t.damping.active:t.damping.inactive),t.speed.theta*=1-(n.isDown?t.damping.active:t.damping.inactive),t.spherical.phi+=t.speed.phi,t.spherical.theta+=t.speed.theta,t.position.setFromSpherical(t.spherical),n.isDown||t.target.copy(t.base);var o=this.view.parallax;F.touch||(o.x=this.cursorPositionControls.normalized.x*o.multiplier,o.y=this.cursorPositionControls.normalized.y*o.multiplier,o.eased.x+=(o.x-o.eased.x)*o.eased.multiplier*this.time.delta,o.eased.y+=(o.y-o.eased.y)*o.eased.multiplier*this.time.delta),e.position.copy(this.view.position),e.rotation.copy(this.view.rotation),e.position.lerp(t.position,t.mixStrength*t.reveal);var a=e.rotation.clone();e.lookAt(this.scene.position);var s=e.rotation.clone();s.x-=V.orientation===U?.04:0,e.rotation.copy(a),e.rotation.y=e.rotation.y+(s.y-e.rotation.y)*(t.mixStrength*t.reveal),e.rotation.x=e.rotation.x+(s.x-e.rotation.x)*(t.mixStrength*t.reveal),e.translateX(o.eased.x),e.translateY(o.eased.y),e.rotateY(o.eased.x*o.rotationMultiplier),e.rotateX(-o.eased.y*o.rotationMultiplier),e.translateX(this.view.coordinates.final.position.x*(V.width/V.height-1)),e.translateY(this.view.coordinates.final.position.y),e.translateZ(this.view.coordinates.final.position.z)}},{key:"_buildView",value:function(){var e=this,t=this.tweens,n=this.world.points,i={};return i.position=new p.Three.Vector3(0,0,1.75),i.rotation=new p.Three.Euler(0,0,0,"YXZ"),i.ratioOffset=.5,i.parallax={},i.parallax.multiplier=.06,i.parallax.rotationMultiplier=1,i.parallax.x=0,i.parallax.y=0,i.parallax.z=0,i.parallax.eased={},i.parallax.eased.multiplier=.005,i.parallax.eased.x=0,i.parallax.eased.y=0,i.parallax.eased.z=0,i.coordinates={},i.coordinates.current=null,i.coordinates.default={position:{x:0,y:0,z:3.15},rotation:{x:0,y:0,z:0},parallaxRotation:.2,depthOfField:{enabled:!1}},i.coordinates.final={position:{x:0,y:0,z:0}},i.leave=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"power4.inOut";e._killTweens(),i.coordinates.current=null,0===n?(i.position.copy(i.coordinates.default.position),i.rotation.x=i.coordinates.default.rotation.x,i.rotation.y=i.coordinates.default.rotation.y,i.rotation.z=i.coordinates.default.rotation.z,i.parallax.rotationMultiplier=i.coordinates.default.parallaxRotation):(t.viewPosition=p.gsap.to(i.position,be({duration:n,ease:r},i.coordinates.default.position)),t.viewRotation=p.gsap.to(i.rotation,be({duration:n,ease:r},i.coordinates.default.rotation)),t.viewOffsetRotationMultiplier=p.gsap.to(i.parallax,{duration:n,ease:r,rotationMultiplier:i.coordinates.default.parallaxRotation})),i.coordinates.default.depthOfField.enabled?e.depthOfField.activate(i.coordinates.default.depthOfField.focus,i.coordinates.default.depthOfField.aperture,i.coordinates.default.depthOfField.maxblur,n):e.depthOfField.deactivate(n)},i.go=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"power4.inOut",a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=e.world.points.items.find((function(e){return e.name===n})).view;i.coordinates.current&&i.coordinates.current===s&&!a||(e._killTweens(),i.coordinates.current=s,0===r?(i.position.copy(s.position),i.rotation.x=s.rotation.x,i.rotation.y=s.rotation.y,i.rotation.z=s.rotation.z,i.parallax.rotationMultiplier=s.parallaxRotation):(t.viewPosition=p.gsap.to(i.position,be({duration:r,ease:o},s.position)),t.viewRotation=p.gsap.to(i.rotation,be({duration:r,ease:o},s.rotation)),t.viewOffsetRotationMultiplier=p.gsap.to(i.parallax,{duration:r,ease:o,rotationMultiplier:s.parallaxRotation})),s.depthOfField.enabled?e.depthOfField.activate(s.depthOfField.focus,s.depthOfField.aperture,s.depthOfField.maxblur,r):e.depthOfField.deactivate(r))},n.on("tweakPointViewChanged",(function(e){e.view===i.coordinates.current&&i.go(e.name,0,"power4.inOut",!0)})),n.on("tweakPointGo",(function(t){e.goPoint(t.name)})),n.on("tweakPointLeave",(function(){e.leavePoint()})),this.tweaks.getTweak({path:"presets.view",object:i.parallax,objectProperty:"multiplier",presetProperty:"parallaxMultiplier",type:Q,min:0,max:1,step:.001,default:i.parallax.multiplier}),this.tweaks.getTweak({path:"presets.view.placeholder.position",object:i.coordinates.default.position,objectProperty:"x",presetProperty:"X",type:Q,min:-3,max:3,step:.001,default:i.coordinates.default.position.x,onChange:function(){i.position.copy(i.coordinates.default.position)}}),this.tweaks.getTweak({path:"presets.view.placeholder.position",object:i.coordinates.default.position,objectProperty:"y",presetProperty:"Y",type:Q,min:-3,max:3,step:.001,default:i.coordinates.default.position.y,onChange:function(){i.position.copy(i.coordinates.default.position)}}),this.tweaks.getTweak({path:"presets.view.placeholder.position",object:i.coordinates.default.position,objectProperty:"z",presetProperty:"Z",type:Q,min:0,max:9,step:.001,default:i.coordinates.default.position.z,onChange:function(){i.position.copy(i.coordinates.default.position)}}),this.tweaks.getTweak({path:"presets.view.final.position",object:i.coordinates.final.position,objectProperty:"x",presetProperty:"X",type:Q,min:-3,max:3,step:.001,default:i.coordinates.final.position.x}),this.tweaks.getTweak({path:"presets.view.final.position",object:i.coordinates.final.position,objectProperty:"y",presetProperty:"Y",type:Q,min:-2.5,max:2.5,step:.001,default:i.coordinates.final.position.y}),this.tweaks.getTweak({path:"presets.view.final.position",object:i.coordinates.final.position,objectProperty:"z",presetProperty:"Z",type:Q,min:-3,max:5,step:.001,default:i.coordinates.final.position.z}),i}},{key:"_buildOrbitControls",value:function(){var e=this,t=this.tweens,n={active:!1,reveal:1,multiplier:3,mixStrength:0,traction:{active:.025,inactive:.093},damping:{active:.15,inactive:.17}};return n.base=new p.Three.Spherical(2.6,.53*Math.PI,0),n.base.radius=2.6+1.75*Math.max(V.height/V.width-1,0),n.spherical=n.base.clone(),n.target=n.base.clone(),n.speed={phi:0,theta:0},n.position=new p.Three.Vector3,n.position.setFromSpherical(n.spherical),n.eased={},n.eased.multiplier=.005,n.eased.value=new p.Three.Spherical,n.limits={},n.limits.phi={min:.2*Math.PI,max:.8*Math.PI},n.activate=function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"power4.inOut";n.active||(n.active=!0,e.dragControls.active=!0,t.orbitControlsMixStrength&&t.orbitControlsMixStrength.kill(),t.orbitControlsMixStrength=p.gsap.to(n,{duration:i,ease:r,mixStrength:1}),e.$target.classList.add("grabbable"))},n.deactivate=function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"power4.inOut";n.active&&(n.active=!1,e.dragControls.active=!1,t.orbitControlsMixStrength&&t.orbitControlsMixStrength.kill(),t.orbitControlsMixStrength=p.gsap.to(n,{duration:i,ease:r,mixStrength:0}),e.$target.classList.remove("grabbable"))},this.dragControls.on(me,(function(){e.$target.classList.add("grabbing")})),this.dragControls.on(ve,(function(){e.world.orbit.hide()})),this.dragControls.on("up",(function(){e.$target.classList.remove("grabbing"),e.world.orbit.show()})),this.tweaks.getTweak({path:"presets.orbitControls",object:n.traction,objectProperty:"active",presetProperty:"activeTraction",type:Q,min:0,max:.5,step:.001,default:n.traction.active}),this.tweaks.getTweak({path:"presets.orbitControls",object:n.damping,objectProperty:"active",presetProperty:"activeDamping",type:Q,min:0,max:.5,step:.001,default:n.damping.active}),this.tweaks.getTweak({path:"presets.orbitControls",object:n.traction,objectProperty:"inactive",presetProperty:"inactiveTraction",type:Q,min:0,max:.5,step:.001,default:n.traction.inactive}),this.tweaks.getTweak({path:"presets.orbitControls",object:n.damping,objectProperty:"inactive",presetProperty:"inactiveDamping",type:Q,min:0,max:.5,step:.001,default:n.damping.inactive}),n}},{key:"_killTweens",value:function(){this.tweens.viewPosition&&this.tweens.viewPosition.kill(),this.tweens.viewRotation&&this.tweens.viewRotation.kill(),this.tweens.viewOffsetRotationMultiplier&&this.tweens.viewOffsetRotationMultiplier.kill(),this.tweens.viewRatioOffset&&this.tweens.viewRatioOffset.kill()}}]),o}(p.EventEmitter);var ke=function(){function t(n){e(this,t),this.tweaks=n.tweaks,this.stats=n.stats,this.scene=n.scene,this.camera=n.camera,this.usePostprocess=F.gpu.tier>=2,this._setInstance(n.rendererInstance),this._setPostProcess()}return a(t,[{key:"update",value:function(){this.stats&&this.stats.beforeRender(),this.usePostprocess&&this.postProcess.bokehPass.enabled?this.postProcess.composer.render():this.instance.render(this.scene,this.camera.instance),this.stats&&this.stats.afterRender()}},{key:"resize",value:function(){this.instance.setSize(V.width,V.height),this.instance.setPixelRatio(F.pixelRatio),this.postProcess.composer.setSize(V.width,V.height),this.postProcess.composer.setPixelRatio(F.pixelRatio)}},{key:"destroy",value:function(){this.instance.renderLists.dispose(),this.instance.dispose(),this.renderTarget.dispose(),this.postProcess.composer.renderTarget1.dispose(),this.postProcess.composer.renderTarget2.dispose()}},{key:"_setInstance",value:function(e){var t=this;this.instance=e,this.instance.domElement.style.position="absolute",this.instance.domElement.style.top=0,this.instance.domElement.style.left=0,this.instance.domElement.style.width="100%",this.instance.domElement.style.height="100%",this.instance.setClearColor("#010101",1),this.instance.setSize(V.width,V.height),this.instance.setPixelRatio(F.pixelRatio),this.instance.physicallyCorrectLights=!0,this.instance.gammaOutPut=!0,this.instance.outputEncoding=p.Three.sRGBEncoding,this.instance.shadowMap.type=p.Three.PCFSoftShadowMap,this.instance.shadowMap.enabled=!1,this.instance.autoClear=!0,this.instance.toneMapping=p.Three.NoToneMapping,this.instance.toneMappingExposure=1.3,this.instance.sortObjects=!1,this.context=this.instance.getContext(),this.stats&&this.stats.setRenderPanel(this.context),this.tweaks.getTweak({path:"presets.toneMapping",object:this.instance,objectProperty:"toneMapping",presetProperty:"type",type:J,default:p.Three.NoToneMapping,options:[{text:"No",value:p.Three.NoToneMapping},{text:"Linear",value:p.Three.LinearToneMapping},{text:"Reinhard",value:p.Three.ReinhardToneMapping},{text:"Cineon",value:p.Three.CineonToneMapping},{text:"ACESFilmic",value:p.Three.ACESFilmicToneMapping}],onChange:function(){t.scene.traverse((function(e){e instanceof p.Three.Mesh&&(e.material.needsUpdate=!0)}))}}),this.tweaks.getTweak({path:"presets.toneMapping",object:this.instance,objectProperty:"toneMappingExposure",presetProperty:"exposure",type:Q,min:0,max:10,step:.001,default:1})}},{key:"_setPostProcess",value:function(){this.postProcess={},this.postProcess.renderPass=new p.RenderPass(this.scene,this.camera.instance),this.postProcess.gammaCorrectionPass=new p.ShaderPass(p.GammaCorrectionShader),this.postProcess.bokehPass=new p.BokehPass(this.scene,this.camera.instance,{focus:.75,aperture:0,maxblur:.01,width:V.width,height:V.height}),this.postProcess.bokehPass.enabled=!1;var e=p.Three.WebGLRenderTarget;this.renderTarget=new e(V.width,V.height,{generateMipmaps:!1,minFilter:p.Three.LinearFilter,magFilter:p.Three.LinearFilter,format:p.Three.RGBAFormat,encoding:p.Three.sRGBEncoding}),this.postProcess.composer=new p.EffectComposer(this.instance,this.renderTarget),this.postProcess.composer.setSize(V.width,V.height),this.postProcess.composer.setPixelRatio(F.pixelRatio),this.postProcess.composer.addPass(this.postProcess.renderPass),this.postProcess.composer.addPass(this.postProcess.gammaCorrectionPass),this.postProcess.composer.addPass(this.postProcess.bokehPass)}}]),t}();function xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Pe(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _e(e,t){if(e){if("string"==typeof e)return xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xe(e,t):void 0}}function Te(e){return function(e){if(Array.isArray(e))return xe(e)}(e)||Pe(e)||_e(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Me="file_end";const Ce=function(t){c(o,t);var n,i,r=(n=o,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(n);if(i){var r=h(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return u(this,e)});function o(t){var n;return e(this,o),(n=r.call(this)).toLoad=0,n.loaded=0,n.items={},n._setLoaders(t),n}return a(o,[{key:"_setLoaders",value:function(e){var t=this;t.loaders=[],t.loaders.push({extensions:["jpg","png"],action:function(e){var n=new Image;(0,p.listen)(n,!0,b,(function(){t._fileLoadEnd(e,n)}),{once:!0}),(0,p.listen)(n,!0,"error",(function(){t._fileLoadEnd(e,n)}),{once:!0}),n.src=e.source}}),t.basisLoader=new p.BasisTextureLoader,t.basisLoader.setTranscoderPath(F.getDecoderPath("basis")),t.basisLoader.detectSupport(e),t.loaders.push({extensions:["basis"],action:function(e){t.basisLoader.load(e.source,(function(n){t._fileLoadEnd(e,n)}))}}),t.dracoLoader=new p.DRACOLoader,t.dracoLoader.setDecoderPath(F.getDecoderPath("draco")),t.dracoLoader.setDecoderConfig({type:"js"}),t.loaders.push({extensions:["drc"],action:function(e){t.dracoLoader.load(e.source,(function(n){t.fileLoadEnd(e,n),p.DRACOLoader.releaseDecoderModule()}))}}),t.gltfLoader=new p.GLTFLoader,t.gltfLoader.setDRACOLoader(t.dracoLoader),t.loaders.push({extensions:["glb","gltf"],action:function(e){t.gltfLoader.load(e.source,(function(n){t._fileLoadEnd(e,n)}))}}),t.fbxLoader=new p.FBXLoader,t.loaders.push({extensions:["fbx"],action:function(e){t.fbxLoader.load(e.source,(function(n){t._fileLoadEnd(e,n)}))}}),t.rgbeLoader=new p.RGBELoader,t.loaders.push({extensions:["hdr"],action:function(e){t.rgbeLoader.load(e.source,(function(n){t._fileLoadEnd(e,n)}))}})}},{key:"load",value:function(){var e,t=this,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Re(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]);try{var i=function(){var n=e.value;if(t.toLoad++,"loadType"in n)switch(n.loadType){case"daynumbers":n.source=n.base+(new Date).getDate()+n.extension;break;case"dayletters":n.source=n.base+(new Date).getDay()+n.extension;break;case"monthletters":n.source=n.base+(new Date).getMonth()+n.extension;break;default:console.log("Not good LoadType for this resource : "+n.name)}var i=n.source.match(/\.([a-z]+)$/);if(void 0!==i[1]){var r=i[1],o=t.loaders.find((function(e){return e.extensions.find((function(e){return e===r}))}));o?o.action(n):console.warn("Cannot found loader for ".concat(n))}else console.warn("Cannot found extension of ".concat(n))};for(n.s();!(e=n.n()).done;)i()}catch(e){n.e(e)}finally{n.f()}}},{key:"_fileLoadEnd",value:function(e,t){this.loaded++,this.items[e.name]=t,this.trigger(Me,[e,t]),this.loaded===this.toLoad&&this.trigger(f)}}]),o}(p.EventEmitter);var je="groupEnd";const Se=function(t){c(o,t);var n,i,r=(n=o,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(n);if(i){var r=h(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return u(this,e)});function o(t,n){var i;return e(this,o),(i=r.call(this)).items={},i.loader=new Ce(n),i.groups={},i.groups.assets=Te(t),i.groups.loaded=[],i.groups.current=null,i.loader.on(Me,(function(e,t){var n=t;"texture"===e.type&&(n instanceof p.Three.Texture||(n=new p.Three.Texture(t)),n.needsUpdate=!0),n.doubleSide=e.doubleSide,i.items[e.name]=n,i.groups.current.loaded++,i.trigger(_,[i.groups.current,e,n])})),i.loader.on(f,(function(){i.groups.loaded.push(i.groups.current),i.trigger(je,[i.groups.current]),i.groups.assets.length>0?i._loadNext():i.trigger(f)})),i._loadNext(),i}return a(o,[{key:"destroy",value:function(){if(this.items)for(var e in this.items){var t=this.items[e];t instanceof p.Three.Texture&&t.dispose()}this.items=null}},{key:"_loadNext",value:function(){this.groups.current=this.groups.assets.shift(),this.groups.current.toLoad=this.groups.current.items.length,this.groups.current.loaded=0,this.loader.load(this.groups.current.items)}}]),o}(p.EventEmitter),Ee="#define GLSLIFY 1\nuniform vec2 uPosition;\nuniform float uRadius;\nuniform vec3 uColorA;\nuniform vec3 uColorB;\nuniform vec3 uColorReveal;\n\nfloat random2D(in vec2 _st)\n{\n    return fract(sin(dot(_st.xy, vec2(12.9898,78.233))) * 43758.5453123);\n}\n\nvec2 getRotatedVec2(vec2 uv, float rotation)\n{\n    float mid = 0.5;\n    return vec2(\n        cos(rotation) * (uv.x - mid) + sin(rotation) * (uv.y - mid) + mid,\n        cos(rotation) * (uv.y - mid) - sin(rotation) * (uv.x - mid) + mid\n    );\n}\n\nvarying vec2 vUv;\n\n#ifdef USE_REVEAL\n    uniform vec2 uResolution;\n    uniform float uRevealProgress;\n    uniform vec2 uRevealOffset;\n\n    bool getCircularRevealProgress()\n    {\n        if(uRevealProgress > 0.999)\n        {\n            return false;\n        }\n\n        vec2 uv = gl_FragCoord.xy;\n        uv /= uResolution;\n        uv -= 0.5;\n        uv -= uRevealOffset * 0.5;\n\n        uv.x *= uResolution.x / uResolution.y;\n        \n        float distanceToCenter = length(uv) / (max(uResolution.x, uResolution.y) / min(uResolution.y, uResolution.x)) * 1.25;\n\n        if(distanceToCenter >= uRevealProgress)\n        {\n            return true;\n        }\n        else\n        {\n            return false;\n        }\n    }\n\n    \n#endif\n\nvoid main()\n{\n    // Gradient\n    float gradientStrength = clamp(distance(vUv, uPosition) / uRadius, 0.0, 1.0);\n    vec3 color = mix(uColorA, uColorB, gradientStrength);\n\n    // Reveal\n    #ifdef USE_REVEAL\n        float progress = getCircularRevealProgress() ? 1.0 : 0.0;\n        color = mix(color, uColorReveal, progress);\n    #endif\n\n    gl_FragColor = vec4(color, 1.0);\n    // gl_FragColor = vec4(vec3(progress), 1.0);\n\n    // #include <tonemapping_fragment>\n    #include <encodings_fragment>\n    // #include <fog_fragment>\n    // #include <premultiplied_alpha_fragment>\n    // #include <dithering_fragment>\n}",Oe="#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main()\n{\n    gl_Position = vec4(position, 1.0);\n\n    vUv = uv;\n}";function Le(){return new p.Three.ShaderMaterial({wireframe:!1,transparent:!1,depthTest:!0,depthWrite:!1,uniforms:{uRevealProgress:{value:null},uRevealOffset:{value:null},uResolution:{value:null},uTime:{value:null},uPosition:{value:null},uRadius:{value:null},uColorA:{value:null},uColorB:{value:null},uColorReveal:{value:null}},extensions:{derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},defines:{USE_REVEAL:""},lights:!1,vertexShader:Oe,fragmentShader:Ee})}const Ie=function(){function t(n){e(this,t),this.scene=n.scene,this.tweaks=n.tweaks,this.loading=n.loading,this._setColors(),this._setGeometry(),this._setMaterial(),this._setMesh()}return a(t,[{key:"resize",value:function(){this.material.uniforms.uResolution.value.set(V.width*F.pixelRatio,V.height*F.pixelRatio)}},{key:"_setColors",value:function(){for(var e in this.colors={},this.colors.a={},this.colors.a.value="#890606",this.colors.a.instance=new p.Three.Color(this.colors.a.value),this.colors.b={},this.colors.b.value="#c70101",this.colors.b.instance=new p.Three.Color(this.colors.b.value),this.colors.reveal={},this.colors.reveal.value="#0b0b0b",this.colors.reveal.instance=new p.Three.Color(this.colors.reveal.value),this.colors){var t=this.colors[e];this.tweaks.getTweak({path:"presets.background.colors",object:t,objectProperty:te,presetProperty:e,type:K,default:t.value,apply:function(e){e.object.instance.set(e.value)}})}}},{key:"_setGeometry",value:function(){this.geometry=new p.Three.PlaneBufferGeometry(2,2)}},{key:"_setMaterial",value:function(){this.material=new Le,this.material.uniforms.uRevealProgress.value=0,this.material.uniforms.uRevealOffset.value=this.loading.screenPosition.normalized,this.material.uniforms.uResolution.value=new p.Three.Vector2(V.width*F.pixelRatio,V.height*F.pixelRatio),this.material.uniforms.uPosition.value=new p.Three.Vector2(0,0),this.material.uniforms.uRadius.value=.8,this.material.uniforms.uColorA.value=this.colors.a.instance,this.material.uniforms.uColorB.value=this.colors.b.instance,this.material.uniforms.uColorReveal.value=this.colors.reveal.instance,this.tweaks.getTweak({path:"presets.background",object:this.material.uniforms.uRadius,objectProperty:te,presetProperty:"radius",type:Q,min:0,max:2,step:.001,default:this.material.uniforms.uRadius.value}),this.tweaks.getTweak({path:"presets.background",object:this.material.uniforms.uPosition.value,objectProperty:"x",type:Q,min:-1,max:2,step:.001,default:this.material.uniforms.uPosition.value.x}),this.tweaks.getTweak({path:"presets.background",object:this.material.uniforms.uPosition.value,objectProperty:"y",type:Q,min:-1,max:2,step:.001,default:this.material.uniforms.uPosition.value.y})}},{key:"_setMesh",value:function(){this.mesh=new p.Three.Mesh(this.geometry,this.material),this.mesh.position.z=10,this.mesh.frustumCulled=!1,this.scene.add(this.mesh)}}]),t}(),Ae=function(){function t(n){e(this,t),this.time=n.time,this.resources=n.resources,this.scene=n.scene,this.tweaks=n.tweaks,this.intensity=1,this.pmremGenerator=new p.Three.PMREMGenerator(n.renderer.instance),this.rgbeLoader=new p.RGBELoader,this.dataTextureLoader=new p.Three.DataTextureLoader,this.perpetualRotation=!0,this.rotationX=0,this.rotationY=0,this.rotationZ=0,this.perpetualRotationSpeed=2e-4,this._setTweaks(n.tweaks),this.scene.rotation.x=this.rotationX,this.scene.rotation.y=this.rotationY,this._setTexture()}return a(t,[{key:"update",value:function(){this.perpetualRotation&&(this.rotationZ+=this.perpetualRotationSpeed*this.time.delta),this.scene.rotation.x=this.rotationX,this.scene.rotation.y=this.rotationY,this.scene.rotation.z=this.rotationZ}},{key:"_setTweaks",value:function(e){var t=this;e.getTweak({path:"presets.environmentMap",preset:!1,type:q,title:"import .hdr(i)",onClick:function(){var e=document.createElement("input");e.type="file",e.accept=".hdr",e.addEventListener(d,(function(e){var n=e.target.files[0],i=new FileReader;i.addEventListener(b,(function(){t.rgbeLoader.load(i.result,(function(e){t.renderTarget=t.pmremGenerator.fromEquirectangular(e),t.pmremGenerator.compileCubemapShader(),t.texture=t.renderTarget.texture,t.scene.environment=t.texture,t.scene.traverse((function(e){e instanceof p.Three.Mesh&&e.material instanceof p.Three.MeshStandardMaterial&&(e.material.envMap=t.renderTarget.texture,e.material.uniforms&&e.material.uniforms.envMap&&(e.material.uniforms.envMap.value=t.renderTarget.texture),e.material.needsUpdate=!0)}))}))}),!1),i.readAsDataURL(n)})),e.click()}}),e.getTweak({path:"presets.environmentMap",object:this,objectProperty:"rotationX",type:Q,min:1.5*-Math.PI,max:1.5*Math.PI,step:.001,default:this.rotationX,onChange:function(e){t.scene.rotation.x=e.value}}),e.getTweak({path:"presets.environmentMap",object:this,objectProperty:"rotationY",type:Q,min:1.5*-Math.PI,max:1.5*Math.PI,step:.001,default:this.rotationY,onChange:function(e){t.scene.rotation.y=e.value}}),e.getTweak({path:"presets.environmentMap",object:this,objectProperty:"rotationZ",type:Q,min:1.5*-Math.PI,max:1.5*Math.PI,step:.001,default:this.rotationZ,onChange:function(e){t.scene.rotation.z=e.value}}),e.getTweak({path:"presets.environmentMap",object:this,objectProperty:"perpetualRotation",type:Z,default:!0}),e.getTweak({path:"presets.environmentMap",object:this,objectProperty:"perpetualRotationSpeed",type:Q,min:0,max:.001,step:1e-5,default:this.perpetualRotationSpeed})}},{key:"_setTexture",value:function(){this.renderTarget=this.pmremGenerator.fromEquirectangular(this.resources.items.environmentMap),this.pmremGenerator.compileCubemapShader(),this.texture=this.renderTarget.texture,this.scene.environment=this.texture}}]),t}(),De="#define GLSLIFY 1\n#define STANDARD\n\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifdef IOR\n\tuniform float ior;\n#endif\n\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n\nvarying vec3 vViewPosition;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\n#ifdef USE_REVEAL\n    uniform vec2 uResolution;\n    uniform float uRevealProgress;\n    uniform vec2 uRevealOffset;\n\n    bool getCircularRevealProgress()\n    {\n        if(uRevealProgress > 0.999)\n        {\n            return false;\n        }\n\n        vec2 uv = gl_FragCoord.xy;\n        uv /= uResolution;\n        uv -= 0.5;\n        uv -= uRevealOffset * 0.5;\n\n        uv.x *= uResolution.x / uResolution.y;\n        \n        float distanceToCenter = length(uv) / (max(uResolution.x, uResolution.y) / min(uResolution.y, uResolution.x)) * 1.25;\n\n        if(distanceToCenter >= uRevealProgress)\n        {\n            return true;\n        }\n        else\n        {\n            return false;\n        }\n    }\n\n    \n#endif\n\nvoid main() {\n\n\t// Reveal\n\t#ifdef USE_REVEAL\n\t\tif(!getCircularRevealProgress())\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n\t\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\n\t#include <transmission_fragment>\n\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\n\t#ifdef USE_CLEARCOAT\n\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\n\t\toutgoingLight = outgoingLight * ( 1.0 - clearcoat * Fcc ) + clearcoatSpecular * clearcoat;\n\n\t#endif\n\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}",Fe="#define GLSLIFY 1\n#define STANDARD\n\nvarying vec3 vViewPosition;\n\n#ifdef USE_TRANSMISSION\n\n\tvarying vec3 vWorldPosition;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n#ifdef USE_TRANSMISSION\n\n\tvWorldPosition = worldPosition.xyz;\n\n#endif\n}";function ze(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=p.Three.UniformsUtils.merge([p.Three.ShaderLib.standard.uniforms,{uResolution:{value:null},uRevealProgress:{value:null},uRevealOffset:{value:null},uRevealFrequency:{value:null},uRevealDistortion:{value:null}}]),n={PHYSICAL:"",USE_REVEAL:""};e.map&&(t.map.value=e.map,n.USE_MAP="",n.USE_UV=""),e.emissive&&(t.emissive.value=e.emissive),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap,n.USE_EMISSIVEMAP="",n.USE_UV=""),e.alphaMap&&(t.alphaMap.value=e.alphaMap,n.USE_ALPHAMAP="",n.USE_UV=""),e.aoMap&&(t.aoMap.value=e.aoMap,n.USE_AOMAP="",n.USE_UV=""),e.displacementMap&&(t.displacementMap.value=e.displacementMap,n.USE_DISPLACEMENTMAP="",n.USE_UV=""),e.normalMap&&(t.normalMap.value=e.normalMap,e.normalScale&&(t.normalScale.value=e.normalScale),n.USE_NORMALMAP="",n.USE_UV="",n.TANGENTSPACE_NORMALMAP=""),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap,n.USE_METALNESSMAP="",n.USE_UV=""),e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap,n.USE_ROUGHNESSMAP="",n.USE_UV=""),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity,t.envMap.value=e.envMap,n.USE_ENVMAP=""),e.fogColor&&(t.fogColor.value=e.fogColor,t.fogNear.value=e.fogNear,t.fogFar.value=e.fogFar,t.fogDensity.value=e.fogDensity,n.USE_FOG="",e.fogDensity&&(n.FOG_EXP2="")),e.color&&(t.diffuse.value=e.color),t.roughness.value=e.roughness,t.metalness.value=e.metalness,t.reflectivity.value=.5;var i=new p.Three.ShaderMaterial({wireframe:!1,transparent:!0,depthTest:!0,depthWrite:!0,alphaTest:.1,uniforms:t,extensions:{derivatives:!0,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!0},defines:n,lights:!0,vertexShader:Fe,fragmentShader:De});return e.envMap&&(i.envMap=e.envMap),i}function Ue(e,t,n){return Ue=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct.bind():function(e,t,n){var i=[null];i.push.apply(i,t);var r=new(Function.bind.apply(e,i));return n&&l(r,n.prototype),r},Ue.apply(null,arguments)}function $e(e){return function(e){if(Array.isArray(e))return e}(e)||Pe(e)||_e(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Ve={hdr:new p.RGBELoader,basis:null,default:new p.Three.TextureLoader};function Be(e,t){t.forEach((function(t){switch(t){case"flipY":case"doubleSide":e[t]=!0;break;case"sRGB":e.encoding=p.Three.sRGBEncoding;break;default:console.warn("texture param ".concat(t," will be ignored"))}})),e.needsUpdate=!0}function Ge(e,t,n){var i=0,r=0,o=function(){i+r>=e.length&&(t.needsUpdate=!0,n())};e.forEach((function(e){var n=e.path,a=e.attribute,s=e.params;!function(e,t,n,i){e.endsWith(".hdr")?Ve.hdr.load(e,(function(e){e.mapping=p.Three.EquirectangularReflectionMapping,Be(e,t),n(e)}),null,i):(e.endsWith(".basis")?Ve.basis:Ve.default).load(e,(function(e){e.flipY=!1,Be(e,t),n(e)}),null,i)}(n,s,(function(e){t[a]=e,i+=1,o()}),(function(e){console.warn(" error loading material.".concat(a," (").concat(n,")\n"),e),r+=1,o()}))}))}function Ne(e){var t,n,i,r,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=a.onLoad,l=void 0===s?function(){}:s,c=a.onComplete,u=void 0===c?function(){}:c,h=a.autoload,d=void 0===h||h,f=(t=e.type,o="Mesh"+(i=(n=$e(t||"basic"))[0],r=n.slice(1),(void 0===i?"":i.toUpperCase()+r.join(""))+"Material"),"function"==typeof p.Three[o]?new p.Three[o]:new p.Three.MeshBasicMaterial),m=function(e,t){var n=[];for(var i in e)if(void 0!==t[i])switch(i){case"type":break;case"attenuationColor":case"emissive":case"sheenColor":case"specularColor":case"color":t[i]=new p.Three.Color(e[i]);break;case"aoMap":case"bumpMap":case"envMap":case"map":case"metalnessMap":case"normalMap":case"roughnessMap":var r=$e(e[i].split(" ")),o=r[0],a=r.slice(1);n.push({path:o,attribute:i,params:a});break;case"normalScale":t[i]=Ue(p.Three.Vector2,Te(e[i]));break;default:t[i]=e[i]}else console.warn("".concat(i," will be ignored"));return{assets:n}}(e,f),v=m.assets,g=void 0===v?[]:v;return g.length?d&&(l({material:f,assets:g}),Ge(g,f,(function(){u({material:f,assets:g})}))):"function"==typeof u&&u({material:f,assets:g}),{material:f,assets:g}}const Ye="#define GLSLIFY 1\n#ifdef USE_REVEAL\n    uniform vec2 uResolution;\n    uniform float uRevealProgress;\n    uniform vec2 uRevealOffset;\n\n    bool getCircularRevealProgress()\n    {\n        if(uRevealProgress > 0.999)\n        {\n            return false;\n        }\n\n        vec2 uv = gl_FragCoord.xy;\n        uv /= uResolution;\n        uv -= 0.5;\n        uv -= uRevealOffset * 0.5;\n\n        uv.x *= uResolution.x / uResolution.y;\n        \n        float distanceToCenter = length(uv) / (max(uResolution.x, uResolution.y) / min(uResolution.y, uResolution.x)) * 1.25;\n\n        if(distanceToCenter >= uRevealProgress)\n        {\n            return true;\n        }\n        else\n        {\n            return false;\n        }\n    }\n\n    \n#endif",He=function(){function t(n){e(this,t),this.renderer=n,this.camera=new p.Three.OrthographicCamera(-1,1,1,-1,.1,200),this.camera.position.z=100,this.renderTarget=new p.Three.WebGLRenderTarget(1024,1024,{wrapS:p.Three.ClampToEdgeWrapping,wrapT:p.Three.ClampToEdgeWrapping,magFilter:p.Three.LinearFilter,minFilter:p.Three.LinearFilter,generateMipmaps:!0,format:p.Three.RGBAFormat,type:p.Three.UnsignedByteType,anisotropy:1,encoding:p.Three.sRGBEncoding,depthBuffer:!1,stencilBuffer:!1})}return a(t,[{key:"render",value:function(e){this.renderer.setRenderTarget(this.renderTarget),this.renderer.render(e,this.camera),this.renderer.setRenderTarget(null)}}]),t}();const Xe=function(n){c(s,n);var i,r,o=(i=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(i);if(r){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return u(this,e)});function s(t){var n;return e(this,s),(n=o.call(this)).gallery=t,n.texture=null,n.current=null,n.pendingFaceName=null,n.customRenderer=new He(t.renderer.instance),n._setDebugPlane(t.scene),n._setItems(),n}return a(s,[{key:"change",value:function(e){this.items.has(e)||(this.pendingFaceName=e),this.current=this.items.get(e),this.texture=this.current.texture,this.debugPlane.material.map=this.texture,this.current.start&&this.current.start(),this.trigger(d,[e])}},{key:"update",value:function(){this.current&&this.current.update()}},{key:"_setDebugPlane",value:function(e){this.debugPlane={},this.debugPlane.geometry=new p.Three.PlaneGeometry(.35,.35),this.debugPlane.material=new p.Three.MeshBasicMaterial({toneMapped:!1}),this.debugPlane.mesh=new p.Three.Mesh(this.debugPlane.geometry,this.debugPlane.material),this.debugPlane.mesh.position.z=.65,this.debugPlane.mesh.visible=!1,e.add(this.debugPlane.mesh)}},{key:"_setItems",value:function(){var e=this,n={renderer:this.customRenderer,gallery:this.gallery,videos:F.assets.videos};this.items=new Map,F.watchfaces.forEach((function(i){var r="object"===t(i)?new i.Class(n,i.options):new i(n);r.index=e.items.size,e.items.set(r.name,r),(0,p.isEmpty)(e.pendingFaceName)&&(e.pendingFaceName=r.name)})),this.pendingFaceName&&this.change(this.pendingFaceName)}}]),s}(p.EventEmitter);const We=function(n){c(s,n);var i,r,o=(i=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(i);if(r){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return u(this,e)});function s(t){var n;return e(this,s),(n=o.call(this)).dropManager=t.dropManager,n.tweaks=t.tweaks,n.scene=t.scene,n.resources=t.resources,n.environmentMap=t.world.environmentMap,n.loading=t.loading,n.group=new p.Three.Group,n.scene.add(n.group),n._setDebug(),n._setCommonUniforms(),n._setPlaceholder(n.resources.items.modelPlaceholder),n._setReveal(),n._setRotation(),n._setScale(),n}return a(s,[{key:"setFinal",value:function(e){var t=this,n=this.resources.items;this.final&&(this.tweaks.deleteFolder("presets.model.2-final"),this.final.group.traverse((function(e){e instanceof p.Three.Mesh&&(e.material.dispose(),e.geometry.dispose())})),this.group.remove(this.final.group)),this.final={},this.final.generalEnvMapIntensity=1,this.tweaks.getTweak({path:"presets.model.2-final",preset:!1,type:q,title:"import .glb",onClick:function(){var e=document.createElement("input");e.type="file",e.accept=".glb",e.addEventListener(d,(function(e){var n=e.target.files[0],i=new FileReader;i.addEventListener(b,(function(){t.resources.loader.gltfLoader.load(i.result,(function(e){console.log("loaded",e),t.setFinal(e)}))}),!1),i.readAsDataURL(n)})),e.click()}}),this.tweaks.getTweak({path:"presets.model.2-final",object:this.final,objectProperty:"generalEnvMapIntensity",type:Q,min:0,max:10,step:.001,default:1,onChange:function(){for(var e in t.final.elements){var n=t.final.elements[e];n.mesh.material.envMapIntensity=n.envMapIntensity*t.final.generalEnvMapIntensity}}}),this.final.group=e.scene,this.final.group.scale.set(.01,.01,.01),this.group.add(this.final.group),this.final.elements={},this.final.isMechanical=!1,this.final.group.traverse((function(e){if(e instanceof p.Three.Mesh){var i,r,o,a={};a.mesh=e,a.envMapIntensity=1,a.mesh.layers.enable(1);var s=a.mesh.name;(s.match(/^NEEDLE_H/)||s.match(/^NEEDLE_M/)||s.match(/^NEEDLE_S/))&&(t.final.isMechanical=!0),a.mesh.name.match(/^screen/)&&(a.mesh.name="screen"),a.mesh.castShadow=!0,a.mesh.receiveShadow=!0,!a.mesh.geometry.attributes.uv2&&a.mesh.geometry.attributes.uv&&a.mesh.geometry.setAttribute("uv2",a.mesh.geometry.attributes.uv),a.mesh.material=a.mesh.material.clone();var l=null,c=a.mesh.name+"_BaseColorTexture";if(Object.prototype.hasOwnProperty.call(n,c)){l||(l=new p.Three.MeshStandardMaterial);var u=n[c];l.map=u,l.map.encoding=p.Three.sRGBEncoding,l.map.flipY=!1,u.doubleSide&&(l.side=p.Three.DoubleSide)}var h=a.mesh.name+"_NormalTexture";Object.prototype.hasOwnProperty.call(n,h)&&(l||(l=new p.Three.MeshStandardMaterial),l.normalMap=n[h],l.normalMap.flipY=!1);var d=a.mesh.name+"_OcclusionRoughnessMetallicTexture";Object.prototype.hasOwnProperty.call(n,d)&&(l||(l=new p.Three.MeshStandardMaterial),l.roughnessMap=n[d],l.metalnessMap=n[d],l.aoMap=n[d],l.roughnessMap.flipY=!1);var f=a.mesh.name+"_EmissiveTexture";Object.prototype.hasOwnProperty.call(n,f)&&(l||(l=new p.Three.MeshStandardMaterial),l.transparent=!0,l.emissiveMap=n[f],l.emissiveMap.encoding=p.Three.sRGBEncoding,l.emissiveMap.flipY=!1),l&&(a.mesh.material=l);var m=null===(i=t.tweaks.presets)||void 0===i||null===(r=i.model)||void 0===r||null===(o=r["2-final"])||void 0===o?void 0:o[a.mesh.name];m&&void 0===m.customMaterial?t._setOldGIMaterialTweaks(a):t._setCustomMaterialTweaks(a),a.mesh.material.envMapIntensity=a.envMapIntensity*t.final.generalEnvMapIntensity,t.final.elements[a.mesh.name]=a}})),this._loadCustomAssets(),this.final.elements.screen?(this.final.elements.screen.mesh.material.toneMapped=!1,this.final.elements.screen.mesh.material.color.set("#000000"),this.final.elements.screen.mesh.material.emissive.set("#ffffff"),this.faces&&(this.final.elements.screen.mesh.material.emissiveMap=this.faces.texture,this.final.elements.screen.mesh.material.needsUpdate=!0)):console.warn('The model doesn\'t have a "screen" mesh');var i=function(e){var n=t.final.elements[e].mesh.material;n.onBeforeCompile=function(n){if(n.defines){for(var i in n.defines.USE_REVEAL="",t.commonUniforms){var r=t.commonUniforms[i];n.uniforms[i]=r}n.fragmentShader=n.fragmentShader.replace("#include <common>","\n                        #include <common>\n                        ".concat(Ye,"\n                    ")),n.fragmentShader=n.fragmentShader.replace("void main() {","\n                        void main() {\n                            // Reveal\n                            #ifdef USE_REVEAL\n                                if(getCircularRevealProgress())\n                                {\n                                    discard;\n                                }\n                            #endif\n                    "),"screen"===e&&(n.vertexShader=n.vertexShader.replace("#include <uv_vertex>","\n                            #ifdef USE_UV\n                                vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n                                vUv.y = 1.0 - vUv.y;\n                            #endif\n                        "))}else console.warn("Material ".concat(e," not compatible with reveal"))},"screen"===e&&(n.customProgramCacheKey=function(){return"screen"})};for(var r in this.final.elements)i(r)}},{key:"setFaces",value:function(e){var t=this;(this.final.elements.screen||this.final.isMechanical)&&F.watchfaces&&(this.faces=new Xe(e),this.final.elements.screen&&(this.final.elements.screen.mesh.material.emissiveMap=this.faces.texture,this.final.elements.screen.mesh.material.needsUpdate=!0,this.faces.on(d,(function(){t.final.elements.screen.mesh.material.emissiveMap=t.faces.texture,t.final.elements.screen.mesh.material.needsUpdate=!0}))))}},{key:"show",value:function(){p.gsap.fromTo(this.reveal,{value:0},{duration:3,delay:0,value:1,ease:"power4.inOut"})}},{key:"update",value:function(){this.reveal.value>=1?(this.rotation.ola.set({value:this.rotation.value}),this.group.rotation.y=this.rotation.ola.value):this.group.rotation.y=this.reveal.rotationStart.y+(this.reveal.rotationEnd.y-this.reveal.rotationStart.y)*this.reveal.value,this.group.rotation.x=this.reveal.rotationStart.x+(this.reveal.rotationEnd.x-this.reveal.rotationStart.x)*this.reveal.value,this.group.rotation.z=this.reveal.rotationStart.z+(this.reveal.rotationEnd.z-this.reveal.rotationStart.z)*this.reveal.value,this.group.scale.set(this.scale.value,this.scale.value,this.scale.value),this.faces&&this.faces.update()}},{key:"resize",value:function(){this.commonUniforms.uResolution.value.set(V.width*F.pixelRatio,V.height*F.pixelRatio)}},{key:"_setDebug",value:function(){var e=this;if(this.dropManager){var t=function(t){var n=e.final.elements[t];return n?n.mesh:null};this.dropManager.on(g,(function(n){n.forEach((function(n){if(n.name.endsWith(".json")){var i=new FileReader;i.onload=function(i){var r,o,a,s=i.target;try{r=JSON.parse(s.result)}catch(e){return void console.error("".concat(n.name," is not a valid JSON file"))}o=r.name||n.name.replace(/(\..{2,})$/,""),(a=t(o))||(a=t(prompt("Name of the material to override\navailable: ".concat(Object.keys(e.final.elements).join(", ")),""))),a?a.userData.setCustomMaterial(r):console.warn("Material ".concat(o," not found ?"))},i.readAsText(n)}}))}))}}},{key:"_setCommonUniforms",value:function(){this.commonUniforms={},this.commonUniforms.uRevealProgress={value:0},this.commonUniforms.uResolution={value:new p.Three.Vector2(V.width*F.pixelRatio,V.height*F.pixelRatio)},this.commonUniforms.uRevealOffset={value:this.loading.screenPosition.normalized}}},{key:"_setPlaceholder",value:function(e){var t=this;this.placeholder&&(this.tweaks.deleteFolder("presets.model.1-placeholder"),this.placeholder.group.traverse((function(e){e instanceof p.Three.Mesh&&(e.material.dispose(),e.geometry.dispose())})),this.group.remove(this.placeholder.group)),this.placeholder={},this.placeholder.group=e.scene,this.placeholder.group.scale.set(.01,.01,.01),this.group.add(this.placeholder.group),this.placeholder.material=new ze({color:new p.Three.Color("#050505"),roughness:.5,metalness:1,envMap:this.environmentMap.texture,envMapIntensity:2}),this.placeholder.material.uniforms.uResolution=this.commonUniforms.uResolution,this.placeholder.material.uniforms.uRevealProgress=this.commonUniforms.uRevealProgress,this.placeholder.material.uniforms.uRevealOffset=this.commonUniforms.uRevealOffset,this.placeholder.group.traverse((function(e){e instanceof p.Three.Mesh&&(e.material=t.placeholder.material)})),this.tweaks.getTweak({path:"presets.model.1-placeholder",preset:!1,type:q,title:"import .glb",onClick:function(){var e=document.createElement("input");e.type="file",e.accept=".glb",e.addEventListener(d,(function(e){var n=e.target.files[0],i=new FileReader;i.addEventListener(b,(function(){t.resources.loader.gltfLoader.load(i.result,(function(e){console.log("loaded",e),t._setPlaceholder(e)}))}),!1),i.readAsDataURL(n)})),e.click()}}),this.tweaks.getTweak({path:"presets.model.1-placeholder",object:this.placeholder.material.uniforms.diffuse,objectProperty:te,presetProperty:K,type:K,default:"#050505",apply:function(e){e.object.value.set(e.value)}}),this.tweaks.getTweak({path:"presets.model.1-placeholder",object:this.placeholder.material.uniforms.metalness,objectProperty:te,presetProperty:"metalness",type:Q,min:0,max:1,step:.001,default:0}),this.tweaks.getTweak({path:"presets.model.1-placeholder",object:this.placeholder.material.uniforms.roughness,objectProperty:te,presetProperty:"roughness",type:Q,min:0,max:1,step:.001,default:0}),this.tweaks.getTweak({path:"presets.model.1-placeholder",object:this.placeholder.material.uniforms.envMapIntensity,objectProperty:te,presetProperty:"envMapIntensity",type:Q,min:0,max:50,step:.001,default:2})}},{key:"_setReveal",value:function(){var e=this;this.reveal={value:0,rotationStart:new p.Three.Euler(0,0,0,"YXZ"),rotationEnd:new p.Three.Euler(0,0,0,"YXZ")},this.group.rotation.copy(this.reveal.rotationStart),this.tweaks.getTweak({path:"presets.view.placeholder.rotation",object:this.reveal.rotationStart,objectProperty:"x",presetProperty:"X",type:Q,min:-2*Math.PI,max:2*Math.PI,step:.001,default:this.reveal.rotationStart.x}),this.tweaks.getTweak({path:"presets.view.placeholder.rotation",object:this.reveal.rotationStart,objectProperty:"y",presetProperty:"Y",type:Q,min:-2*Math.PI,max:2*Math.PI,step:.001,default:this.reveal.rotationStart.y}),this.tweaks.getTweak({path:"presets.view.placeholder.rotation",object:this.reveal.rotationStart,objectProperty:"z",presetProperty:"Z",type:Q,min:-2*Math.PI,max:2*Math.PI,step:.001,default:this.reveal.rotationStart.z}),this.tweaks.getTweak({path:"presets.view.final.rotation",object:this.reveal.rotationEnd,objectProperty:"x",presetProperty:"X",type:Q,min:-2*Math.PI,max:2*Math.PI,step:.001,default:this.reveal.rotationEnd.x}),this.tweaks.getTweak({path:"presets.view.final.rotation",object:this.reveal.rotationEnd,objectProperty:"y",presetProperty:"Y",type:Q,min:-2*Math.PI,max:2*Math.PI,step:.001,default:this.reveal.rotationEnd.y,onChange:function(){e.rotation.value=e.reveal.rotationEnd.y}}),this.tweaks.getTweak({path:"presets.view.final.rotation",object:this.reveal.rotationEnd,objectProperty:"z",presetProperty:"Z",type:Q,min:-2*Math.PI,max:2*Math.PI,step:.001,default:this.reveal.rotationEnd.z})}},{key:"_setRotation",value:function(){var e=this;this.rotation={},this.rotation.ola=new p.Ola({value:this.reveal.rotationEnd.y},300),this.rotation.tween=null,this.rotation.forward=null,this.rotation.value=this.reveal.rotationEnd.y,this.rotation.target=0,this.rotation.flip=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,i=Math.round(e.rotation.target/(2*Math.PI)),r=(t?i-1:i+1)*Math.PI*2+e.reveal.rotationEnd.y;return e.rotation.target=r,e.trigger(M),p.gsap.to(e.rotation,{duration:.9*n,ease:"power4.inOut",value:r,onComplete:function(){e.trigger(C)}})}}},{key:"_setScale",value:function(){this.scale=new p.Ola({value:1},1e3)}},{key:"_loadCustomAssets",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.final.assets&&this.final.assets.length){e=this.resources.loader.basisLoader,Ve.basis=e;var i=0;this.final.assets.forEach((function(e){var r=e.material;Ge(e.assets,r,(function(){++i>=t.final.assets.length&&(t.final.assets=[],n||t.trigger(f))}))}))}else n||this.trigger(f)}},{key:"_setOldGIMaterialTweaks",value:function(e){var t=this;this.tweaks.getTweak({path:"presets.model.2-final.".concat(e.mesh.name),object:e.mesh.material,objectProperty:"metalness",type:Q,min:0,max:2,step:.001,default:e.mesh.material.metalness}),this.tweaks.getTweak({path:"presets.model.2-final.".concat(e.mesh.name),object:e.mesh.material,objectProperty:"roughness",type:Q,min:0,max:2,step:.001,default:e.mesh.material.roughness}),this.tweaks.getTweak({path:"presets.model.2-final.".concat(e.mesh.name),object:e,objectProperty:"envMapIntensity",type:Q,min:0,max:10,step:.001,default:e.mesh.material.envMapIntensity,onChange:function(){e.mesh.material.envMapIntensity=e.envMapIntensity*t.final.generalEnvMapIntensity}}),this.tweaks.getTweak({path:"presets.model.2-final.".concat(e.mesh.name),object:e.mesh.material,objectProperty:"aoMapIntensity",type:Q,min:0,max:2,step:.001,default:e.mesh.material.aoMapIntensity}),e.mesh.material.emissiveMap&&this.tweaks.getTweak({path:"presets.model.2-final.".concat(e.mesh.name),object:e.mesh.material,objectProperty:"emissive",type:K,default:"#ffffff",apply:function(e){e.object.emissive.set(e.value)}})}},{key:"_setCustomMaterialTweaks",value:function(e){var n=this,i=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).autoload,i=void 0!==t&&t;return function(t){if(""!==t.value){var r=null;try{r=JSON.parse(F.fixAssetPath(t.value))}catch(n){return t.error=!0,void console.error("CustomMaterial ".concat(e.name," is not a valid JSON"))}t.error=!1;var o=Ne(r,{autoload:!1}),a=o.assets,s=o.material;a&&a.length&&(n.final.assets=n.final.assets||[],n.final.assets.push({material:s,assets:a})),e.material=s,e.material.envMapIntensity*=n.final.generalEnvMapIntensity,i&&n._loadCustomAssets(!0)}}},r=this.tweaks.getTweak({path:"presets.model.2-final.".concat(e.mesh.name),object:e.mesh.userData,objectProperty:"customMaterial",type:ee,lineCount:6,default:"",apply:function(t){return i(e.mesh)(t)},onChange:function(t){return i(e.mesh,{autoload:!0})(t)}});e.mesh.userData.setCustomMaterial=function(n){e.mesh.userData.customMaterial="object"===t(n)?JSON.stringify(n):n,r.value=e.mesh.userData.customMaterial,r.input.refresh()}}}]),s}(p.EventEmitter),Ze=function(){function t(n){e(this,t),this.scene=n.scene,this.camera=n.camera.instance,this.visible=!1,this.shouldShow=!0,this.radius=.37,this._setCircle(),this._setPoint(),this._setTweaks(n.tweaks)}return a(t,[{key:"show",value:function(){var e=this;this.visible||(this.visible=!0,this.shouldShow=!0,this.scene.add(this.circle.mesh),this.scene.add(this.point.object),p.gsap.killTweensOf(this.circle.material),p.gsap.killTweensOf(this.circle.mesh.scale),this.canBeVisibleDelay&&this.canBeVisibleDelay.kill(),p.gsap.to(this.circle.material,{duration:.25,opacity:.2}),p.gsap.to(this.circle.mesh.scale,{duration:1.25,ease:"elastic.out(1.5, 0.6)",x:1,y:1,z:1}),this.canBeVisibleDelay=p.gsap.delayedCall(.5,(function(){e.point.canBeVisible=!0})))}},{key:"hide",value:function(){var e=this;this.visible&&(this.visible=!1,p.gsap.killTweensOf(this.circle.material),p.gsap.killTweensOf(this.circle.mesh.scale),this.canBeVisibleDelay&&this.canBeVisibleDelay.kill(),p.gsap.to(this.circle.material,{duration:.25,delay:.5,opacity:0,onComplete:function(){e.scene.remove(e.circle.mesh),e.scene.remove(e.point.object)}}),p.gsap.to(this.circle.mesh.scale,{duration:.75,ease:"back.in(1.5)",x:.6,y:.6,z:.6}),this.point.canBeVisible=!1)}},{key:"update",value:function(){if(this.visible&&this.point.canBeVisible){var e=new p.Three.Vector3;e.applyMatrix4(this.point.object.matrixWorld),this.point.screenPosition.normalized.copy(e),this.point.screenPosition.normalized.project(this.camera),this.point.visible=this.point.screenPosition.normalized.x>-1&&this.point.screenPosition.normalized.x<1&&this.point.screenPosition.normalized.y>-1&&this.point.screenPosition.normalized.y<1,this.point.visible&&(this.point.screenPosition.style.x=this.point.screenPosition.normalized.x*V.width*.5+.5*V.width,this.point.screenPosition.style.x=Math.round(4*this.point.screenPosition.style.x)/4,this.point.screenPosition.style.y=-this.point.screenPosition.normalized.y*V.height*.5+.5*V.height,this.point.screenPosition.style.y=Math.round(4*this.point.screenPosition.style.y)/4)}else this.point.visible=!1}},{key:"_setCircle",value:function(){this.circle={},this.circle.geometry=new p.Three.TorusGeometry(this.radius,.00175,5,100),this.circle.geometry.rotateX(.5*Math.PI),this.circle.material=new p.Three.MeshBasicMaterial({color:"#ffffff",opacity:this.visible?.2:0,transparent:!0,toneMapped:!1}),this.circle.mesh=new p.Three.Mesh(this.circle.geometry,this.circle.material),this.visible||this.circle.mesh.scale.set(.6,.6,.6),this.visible&&this.scene.add(this.circle.mesh)}},{key:"_setPoint",value:function(){this.point={},this.point.angle=.57*Math.PI,this.point.canBeVisible=this.visible,this.point.visible=!1,this.point.screenPosition={},this.point.screenPosition.normalized=new p.Three.Vector3,this.point.screenPosition.style={x:0,y:0},this.point.object=new p.Three.Object3D,this.point.object.position.x=Math.cos(this.point.angle)*this.radius,this.point.object.position.z=Math.sin(this.point.angle)*this.radius,this.point.object.position.add(this.circle.mesh.position),this.visible&&this.scene.add(this.point.object)}},{key:"_setTweaks",value:function(e){var t=this;e.getTweak({path:"others.orbit",preset:!1,type:q,title:"show()",onClick:function(){t.show()}}),e.getTweak({path:"others.orbit",preset:!1,type:q,title:"hide()",onClick:function(){t.hide()}}),e.getTweak({path:"presets.orbit",object:this.point,objectProperty:"angle",presetProperty:"orbitPointAngle",type:Q,min:0,max:2*Math.PI,step:.001,default:this.point.angle,apply:function(e){t.point.object.position.x=Math.cos(e.value)*t.radius,t.point.object.position.z=Math.sin(e.value)*t.radius}})}}]),t}();function qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}const Je=function(t){c(o,t);var n,i,r=(n=o,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(n);if(i){var r=h(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return u(this,e)});function o(t){var n;return e(this,o),(n=r.call(this)).tweaks=t.tweaks,n.camera=t.camera,n.scene=t.scene,n.canBeVisible=!1,n.transforms=!1,n.items=[],n._debug={visible:!0},n._setTweaks(t.tweaks),n}return a(o,[{key:"update",value:function(){var e,t=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return qe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qe(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(this.items);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(this.canBeVisible){var i=new p.Three.Vector3;i.applyMatrix4(n.object.matrixWorld),n.screenPosition.normalized.copy(i),n.screenPosition.normalized.project(this.camera.instance),n.visible=n.screenPosition.normalized.x>-1&&n.screenPosition.normalized.x<1&&n.screenPosition.normalized.y>-1&&n.screenPosition.normalized.y<1,n.visible&&(n.screenPosition.style.x=n.screenPosition.normalized.x*V.width*.5+.5*V.width,n.screenPosition.style.x=Math.round(4*n.screenPosition.style.x)/4,n.screenPosition.style.y=-n.screenPosition.normalized.y*V.height*.5+.5*V.height,n.screenPosition.style.y=Math.round(4*n.screenPosition.style.y)/4)}else n.visible=!1}}catch(e){t.e(e)}finally{t.f()}}},{key:"_setTweaks",value:function(e){var t=this,n={in:{duration:2.5,ease:"power4.inOut"},out:{duration:3,ease:"power4.inOut"}};this.animations=n,e.getTweak({path:"presets.points.animations.in",object:n.in,objectProperty:"duration",type:Q,min:0,max:5,step:.01,default:n.in.duration}),e.getTweak({path:"presets.points.animations.in",object:n.in,objectProperty:"ease",type:J,default:n.in.ease,options:[{text:"none",value:"none"},{text:"power1.in",value:"power1.in"},{text:"power2.in",value:"power2.in"},{text:"power3.in",value:"power3.in"},{text:"power4.in",value:"power4.in"},{text:"power1.out",value:"power1.out"},{text:"power2.out",value:"power2.out"},{text:"power3.out",value:"power3.out"},{text:"power4.out",value:"power4.out"},{text:"power1.inOut",value:"power1.inOut"},{text:"power2.inOut",value:"power2.inOut"},{text:"power3.inOut",value:"power3.inOut"},{text:"power4.inOut",value:"power4.inOut"}]}),e.getTweak({path:"presets.points.animations.out",object:n.out,objectProperty:"duration",type:Q,min:0,max:5,step:.01,default:n.out.duration}),e.getTweak({path:"presets.points.animations.out",object:n.out,objectProperty:"ease",type:J,default:n.out.ease,options:[{text:"none",value:"none"},{text:"power1.in",value:"power1.in"},{text:"power2.in",value:"power2.in"},{text:"power3.in",value:"power3.in"},{text:"power4.in",value:"power4.in"},{text:"power1.out",value:"power1.out"},{text:"power2.out",value:"power2.out"},{text:"power3.out",value:"power3.out"},{text:"power4.out",value:"power4.out"},{text:"power1.inOut",value:"power1.inOut"},{text:"power2.inOut",value:"power2.inOut"},{text:"power3.inOut",value:"power3.inOut"},{text:"power4.inOut",value:"power4.inOut"}]});var i=e.getTweak({path:"presets.points.items",presetProperty:"name",default:"pointName",preset:!1,type:ee}),r=e.getTweak({path:"presets.points.items",presetProperty:"type",default:"default",preset:!1,type:J,options:[{text:"default",value:"default"},{text:"thumbnail",value:"thumbnail"},{text:"action",value:"action"}]});e.getTweak({path:"presets.points.items",preset:!1,type:q,title:"add",onClick:function(){i.value.match(/^[a-zA-Z_-]+$/)&&"pointName"!==i.value?t._createItem(i.value,r.value):alert("Wrong format\nShould be something like super-man, spiderMan or ant_man (no space, no special char)")}}),e.getTweak({path:"presets.points.items",preset:!1,type:q,title:"leave",onClick:function(){t.trigger("tweakPointLeave")}}),this._importPresetItems(),e.on("presetsApplied",(function(){console.log("presetsApplied"),t._clearAllItems();var e=setTimeout((function(){t._importPresetItems(),clearTimeout(e),e=null}),0)})),this.tweaks.getTweak({path:"others.ui",preset:!1,object:this._debug,objectProperty:"visible",type:Z,default:this._debug.visible,onChange:function(e){e.value?document.body.classList.remove("ui-hidden"):document.body.classList.add("ui-hidden")}})}},{key:"_createItem",value:function(e,t){var n=this,i=this.tweaks,r={};r.name=e,r.visible=!1,r.type=t,r.x=0,r.y=0,r.z=0,r.screenPosition={},r.screenPosition.normalized=new p.Three.Vector3,r.screenPosition.style={x:0,y:0},r.view={},r.view.parallaxRotation=.5,r.view.position={x:0,y:0,z:0},r.view.rotation={x:0,y:0,z:0},r.view.depthOfField={},r.view.depthOfField.focus=0,r.view.depthOfField.aperture=0,r.view.depthOfField.maxblur=0,r.object=new p.Three.Object3D,r.object.position.set(r.x,r.y,r.z),this.scene.add(r.object),this.items.push(r),i.getTweak({path:"presets.points.items.".concat(r.name),object:r,objectProperty:"name",type:ee,default:r.name,onChange:function(e,t){i.updatePath("points.".concat(t),"points.".concat(e.value))},disable:!0}),i.getTweak({path:"presets.points.items.".concat(r.name),object:r,objectProperty:"type",type:J,options:[{text:"default",value:"default"},{text:"thumbnail",value:"thumbnail"},{text:"action",value:"action"}],default:r.type,disable:!0}),"thumbnail"!==r.type&&(r.dummy=new p.Three.Mesh(new p.Three.BoxGeometry(.05,.05,.05),new p.Three.MeshBasicMaterial({color:"#ffffff",wireframe:!0,depthTest:!1,depthWrite:!0,transparent:!0})),r.dummy.visible=!1,r.object.add(r.dummy),i.getTweak({path:"presets.points.items.".concat(r.name),preset:!1,object:r.dummy,objectProperty:"visible",presetProperty:"dummyVisible",type:Z,default:!1}),i.getTweak({path:"presets.points.items.".concat(r.name),object:r,objectProperty:"x",type:Q,min:-.5,max:.5,step:.001,default:0,apply:function(e){e.object.object.position.x=e.value}}),i.getTweak({path:"presets.points.items.".concat(r.name),object:r,objectProperty:"y",type:Q,min:-.5,max:.5,step:.001,default:0,apply:function(e){e.object.object.position.y=e.value}}),i.getTweak({path:"presets.points.items.".concat(r.name),object:r,objectProperty:"z",type:Q,min:-.5,max:.5,step:.001,default:0,apply:function(e){e.object.object.position.z=e.value}})),"action"!==r.type&&(i.getTweak({path:"presets.points.items.".concat(r.name,".view"),object:r.view,objectProperty:"parallaxRotation",type:Q,min:0,max:2,step:.001,default:.5,onChange:function(){n.trigger("tweakPointViewChanged",[r])}}),i.getTweak({path:"presets.points.items.".concat(r.name,".view.position"),object:r.view.position,objectProperty:"x",type:Q,min:-3,max:3,step:.001,default:0,onChange:function(){n.trigger("tweakPointViewChanged",[r])}}),i.getTweak({path:"presets.points.items.".concat(r.name,".view.position"),object:r.view.position,objectProperty:"y",type:Q,min:-3,max:3,step:.001,default:0,onChange:function(){n.trigger("tweakPointViewChanged",[r])}}),i.getTweak({path:"presets.points.items.".concat(r.name,".view.position"),object:r.view.position,objectProperty:"z",type:Q,min:-3,max:3,step:.001,default:1.5,onChange:function(){n.trigger("tweakPointViewChanged",[r])}}),i.getTweak({path:"presets.points.items.".concat(r.name,".view.rotation"),object:r.view.rotation,objectProperty:"x",type:Q,min:-2*Math.PI,max:2*Math.PI,step:.001,default:0,onChange:function(){n.trigger("tweakPointViewChanged",[r])}}),i.getTweak({path:"presets.points.items.".concat(r.name,".view.rotation"),object:r.view.rotation,objectProperty:"y",type:Q,min:-2*Math.PI,max:2*Math.PI,step:.001,default:0,onChange:function(){n.trigger("tweakPointViewChanged",[r])}}),i.getTweak({path:"presets.points.items.".concat(r.name,".view.rotation"),object:r.view.rotation,objectProperty:"z",type:Q,min:-2*Math.PI,max:2*Math.PI,step:.001,default:0,onChange:function(){n.trigger("tweakPointViewChanged",[r])}}),i.getTweak({path:"presets.points.items.".concat(r.name,".view.depthOfField"),object:r.view.depthOfField,objectProperty:"enabled",type:Z,default:!0,onChange:function(){n.trigger("tweakPointViewChanged",[r])}}),i.getTweak({path:"presets.points.items.".concat(r.name,".view.depthOfField"),object:r.view.depthOfField,objectProperty:"focus",type:Q,min:0,max:2,step:.001,default:.1,onChange:function(){n.trigger("tweakPointViewChanged",[r])}}),i.getTweak({path:"presets.points.items.".concat(r.name,".view.depthOfField"),object:r.view.depthOfField,objectProperty:"aperture",type:Q,min:0,max:.1,step:.001,default:.04,onChange:function(){n.trigger("tweakPointViewChanged",[r])}}),i.getTweak({path:"presets.points.items.".concat(r.name,".view.depthOfField"),object:r.view.depthOfField,objectProperty:"maxblur",type:Q,min:0,max:.1,step:.001,default:.01,onChange:function(){n.trigger("tweakPointViewChanged",[r])}}),i.getTweak({path:"presets.points.items.".concat(r.name),preset:!1,type:q,title:"go",onClick:function(){n.trigger("tweakPointGo",[r])}})),i.getTweak({path:"presets.points.items.".concat(r.name),preset:!1,type:q,title:"delete",onClick:function(){n._deleteItem(r)}})}},{key:"_deleteItem",value:function(e){this.scene.remove(e.object),e.dummy&&e.object.remove(e.dummy);var t=this.items.indexOf(e);this.items.splice(t,1),this.tweaks.deleteFolder("presets.points.items.".concat(e.name))}},{key:"_clearAllItems",value:function(){for(var e=this.items.length;e--;)this._deleteItem(this.items[e])}},{key:"_importPresetItems",value:function(){for(;this.items.length;)this._deleteItem(this.items[0]);for(var e in this.tweaks.presets.points.items){var t=this.tweaks.presets.points.items[e];this._createItem(t.name,t.type)}}}]),o}(p.EventEmitter),Ke=function(){function t(n){e(this,t),this.time=n.time,this.loading=n.loading,this.scene=n.scene,this.rgbeLoader=new p.RGBELoader,this.textureLoader=new p.Three.TextureLoader,this.visible=!1,this.scale=1,this.rotationX=0,this.rotationY=0,this.rotationZ=0,this.perpetualRotation=!0,this.perpetualRotationSpeed=2e-5,this.rotationSpeedX=0,this.rotationSpeedY=2e-5,this.rotationSpeedZ=0,this.color="#808080",this._setTweaks(n.tweaks),this._setCommonUniforms(),this._setGeometry(),this._setMaterial(),this._setTexture(n.resources),this._setMesh(),this._updateVisible()}return a(t,[{key:"update",value:function(){this.perpetualRotation&&(this.rotationX+=this.rotationSpeedX*this.time.delta,this.rotationY+=this.rotationSpeedY*this.time.delta,this.rotationZ+=this.rotationSpeedZ*this.time.delta),this.mesh.rotation.x=this.rotationX,this.mesh.rotation.y=this.rotationY,this.mesh.rotation.z=this.rotationZ,this.mesh.scale.x=this.scale,this.mesh.scale.y=this.scale,this.mesh.scale.z=this.scale}},{key:"_setTweaks",value:function(e){var t=this;e.getTweak({path:"presets.backgroundHDRI",preset:!1,type:q,title:"import .hdr(i)",onClick:function(){var e=document.createElement("input");e.type="file",e.accept=".hdr, .jpg, .jpeg",e.addEventListener("change",(function(e){var n=e.target.files[0],i=new FileReader;i.addEventListener("load",(function(e){(i.result.startsWith("data:image/jpeg")||i.result.startsWith("data:image/jpg")?t.textureLoader:t.rgbeLoader).load(i.result,(function(e){t._updateTexture(e)}))}),!1),i.readAsDataURL(n)})),e.click()}}),e.getTweak({path:"presets.backgroundHDRI",object:this,objectProperty:"scale",type:Q,min:.1,max:6,step:.001,default:this.scale,onChange:function(e){t.scale=e.value}}),e.getTweak({path:"presets.backgroundHDRI",object:this,objectProperty:"rotationX",type:Q,min:1.5*-Math.PI,max:1.5*Math.PI,step:.001,default:this.rotationX,onChange:function(e){t.rotationX=e.value}}),e.getTweak({path:"presets.backgroundHDRI",object:this,objectProperty:"rotationY",type:Q,min:1.5*-Math.PI,max:1.5*Math.PI,step:.001,default:this.rotationY,onChange:function(e){t.rotationY=e.value}}),e.getTweak({path:"presets.backgroundHDRI",object:this,objectProperty:"rotationZ",type:Q,min:1.5*-Math.PI,max:1.5*Math.PI,step:.001,default:this.rotationZ,onChange:function(e){t.rotationZ=e.value}}),e.getTweak({path:"presets.backgroundHDRI",object:this,objectProperty:"visible",type:Z,default:this.visible,onChange:function(){t._updateVisible()}}),e.getTweak({path:"presets.backgroundHDRI",object:this,objectProperty:"color",type:K,default:this.color,onChange:function(){t.material.color=new p.Three.Color(t.color)}}),e.getTweak({path:"presets.backgroundHDRI.perpetualRotation",object:this,objectProperty:"perpetualRotation",presetProperty:"enabled",type:Z,default:!0}),e.getTweak({path:"presets.backgroundHDRI.perpetualRotation",object:this,objectProperty:"rotationSpeedX",presetProperty:"x",type:Q,min:0,max:.001,step:1e-5,default:this.rotationSpeedX}),e.getTweak({path:"presets.backgroundHDRI.perpetualRotation",object:this,objectProperty:"rotationSpeedY",presetProperty:"y",type:Q,min:0,max:.001,step:1e-5,default:this.rotationSpeedY}),e.getTweak({path:"presets.backgroundHDRI.perpetualRotation",object:this,objectProperty:"rotationSpeedZ",presetProperty:"z",type:Q,min:0,max:.001,step:1e-5,default:this.rotationSpeedZ})}},{key:"_setCommonUniforms",value:function(){this.commonUniforms={},this.commonUniforms.uRevealProgress={value:0},this.commonUniforms.uResolution={value:new p.Three.Vector2(V.width*F.pixelRatio,V.height*F.pixelRatio)},this.commonUniforms.uRevealOffset={value:this.loading.screenPosition.normalized}}},{key:"_setGeometry",value:function(){this.geometry=new p.Three.SphereGeometry(2,24,24),this.geometry.scale(-1,1,1)}},{key:"_setMaterial",value:function(){var e=this;this.material=new p.Three.MeshBasicMaterial({color:this.color}),this.material.defines={},this.material.uniforms={},this.material.uniforms.uResolution=this.commonUniforms.uResolution,this.material.uniforms.uRevealProgress=this.commonUniforms.uRevealProgress,this.material.uniforms.uRevealOffset=this.commonUniforms.uRevealOffset,this.material.onBeforeCompile=function(t){for(var n in t.defines.USE_REVEAL="",e.commonUniforms){var i=e.commonUniforms[n];t.uniforms[n]=i}t.fragmentShader=t.fragmentShader.replace("#include <common>","\n                    #include <common>\n\n                    ".concat(Ye,"\n                ")),t.fragmentShader=t.fragmentShader.replace("void main() {","\n                    void main() {\n\n                        // Reveal\n                        #ifdef USE_REVEAL\n                            if(getCircularRevealProgress())\n                            {\n                               discard;\n                            }\n                        #endif\n                ")}}},{key:"_setMesh",value:function(){this.mesh=new p.Three.Mesh(this.geometry,this.material)}},{key:"_setTexture",value:function(e){var t=this;e.items.backgroundHDRI instanceof HTMLImageElement?this.textureLoader.load(e.items.backgroundHDRI.src,(function(e){t._updateTexture(e)})):this._updateTexture(e.items.backgroundHDRI)}},{key:"_updateTexture",value:function(e){this.texture=e,this.material.map=e,this.material.needsUpdate=!0}},{key:"_updateVisible",value:function(){this.visible?this.scene.add(this.mesh):this.scene.remove(this.mesh)}}]),t}(),Qe=function(){function t(n){e(this,t),this.gallery=n,this.resources=n.resources,this.loading=n.loading,this.points=new Je(n),this._setReveal()}return a(t,[{key:"goLoadStep",value:function(e){var t=this;switch(e){case"base":this.background=new Ie(this.gallery),this.skybox=new Ke(this.gallery),this.environmentMap=new Ae(this.gallery),this.model=new We(this.gallery);break;case"final":this.model.on(f,(function(){t._onModelComplete()})),this.model.setFinal(this.resources.items.modelFinal)}}},{key:"resize",value:function(){this.background&&this.background.resize(),this.model&&this.model.resize()}},{key:"update",value:function(){this.skybox&&this.skybox.update(),this.environmentMap&&this.environmentMap.update(),this.model&&this.model.update(),this.points&&this.points.update(),this.orbit&&this.orbit.update()}},{key:"_onModelComplete",value:function(){var e=this;this.model.setFaces(this.gallery),this.orbit=new Ze(this.gallery),p.gsap.delayedCall(.6,(function(){e.reveal.show(),e.model.show(),e.gallery.navigation.reveal()}))}},{key:"_setReveal",value:function(){var e=this;this.reveal={},this.reveal.value=0,this.reveal.show=function(){p.gsap.fromTo(e.model.commonUniforms.uRevealProgress,{value:0},{duration:1.5,delay:0,value:1,ease:"power4.in",onComplete:function(){e.model.group.remove(e.model.placeholder.model)}}),e.skybox&&p.gsap.fromTo(e.skybox.commonUniforms.uRevealProgress,{value:0},{duration:1.5,delay:.2,value:1,ease:"power4.in"}),p.gsap.fromTo(e.background.material.uniforms.uRevealProgress,{value:0},{duration:1.5,delay:.2,value:1,ease:"power4.in"})}}}]),t}();const et=function(t){c(o,t);var n,i,r=(n=o,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(n);if(i){var r=h(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return u(this,e)});function o(t){var n;return e(this,o),(n=r.call(this)).$target=t.$target,n.time=t.time,n.playing=!0,n.ready=!1,n.tweaks=new oe,n.rendererInstance=new p.Three.WebGLRenderer({alpha:!1,antialias:!0}),n}return a(o,[{key:"setup",value:function(e){var t,n=this;return Promise.all([this.tweaks.loadPresets(F.fixAssetPath(e)),(0,p.getGPU)(this.rendererInstance.getContext()).then((function(e){return F.gpu=e}))]).then((t=F.assets.fonts,new Promise((function(e){p.WebFont.load({custom:t,active:function(){e()},classes:!1})})))).then((function(){n._setDebug(),n._setStats(),n._setThree(),n._setResources(),n._setLoading(),n._setWorld(),n._setDepthOfField(),n._setNavigation(),n.tweaks.getTweak({path:"others.reveal",preset:!1,object:n.world.reveal,objectProperty:te,presetProperty:"reveal",type:Q,min:0,max:1,step:.001,default:0,onChange:function(){n.world.model.group.add(n.world.model.placeholder.group),n.world.model.commonUniforms.uRevealProgress.value=n.world.reveal.value,n.world.background.material.uniforms.uRevealProgress.value=n.world.reveal.value,n.world.skybox.material.uniforms.uRevealProgress.value=n.world.reveal.value,n.world.loading.active=!0,n.world.model.reveal.value=n.world.reveal.value,n.navigation.orbitControls.reveal=n.world.reveal.value}}),n.tweaks.getTweak({path:"others.reveal",preset:!1,type:q,title:"show",onClick:function(){n.world.reveal.show(),n.world.model.show(),n.navigation.orbitControls.reveal=1,n.navigation.orbitControls.deactivate(0,"power0.easeNone"),n.navigation.orbitControls.activate()}}),n.tweaks.getTweak({path:"others.viewport",preset:!1,object:F,objectProperty:"emulateMobile",type:Z,default:F.emulateMobile,onChange:function(e){var t=location.href,n=F.emulateHash;location.href=e.value?t+n:t.replace(n,""),location.reload()}})}))}},{key:"update",value:function(){this.ready&&(this.stats&&this.stats.update(),this.loading&&this.loading.update(),this.controls&&this.controls.update(),this.camera.update(),this.world&&this.world.update(),this.matcaps&&this.matcaps.update(),this.renderer&&this.renderer.update(),this.navigation&&this.navigation.update(),this.depthOfField&&this.depthOfField.update(),this.trigger("updated"))}},{key:"resize",value:function(){this.camera&&this.camera.resize(),this.renderer&&this.renderer.resize(),this.world&&this.world.resize(),this.navigation&&this.navigation.resize()}},{key:"_setDebug",value:function(){if(F.debug){var e=new window.IG.debug.Pane;e.containerElem_.style.width="320px",e.containerElem_.style.maxHeight="calc(100vh - 8px * 2)",e.containerElem_.style.overflowY="scroll",e.containerElem_.style.position="fixed",(0,p.listen)(window,!0,y,(function(t){t.ctrlKey&&"h"===t.key&&(e.hidden=!e.hidden)})),this.tweaks.setDebug(e),this.dropManager=new N(this.$target)}}},{key:"_setStats",value:function(){}},{key:"_setThree",value:function(){var e=this.$target;this.scene=new p.Three.Scene,this.camera=new ue(this),this.renderer=new ke(this),e.appendChild(this.renderer.instance.domElement)}},{key:"_setLoading",value:function(){var e=this;this.loading=new pe(this),this.loading.on(_,(function(t){e.trigger(_,[t])}))}},{key:"_setWorld",value:function(){this.world=new Qe(this)}},{key:"_setResources",value:function(){var e=this;this.resources=new Se(F.assets.resources,this.renderer.instance),this.resources.on(je,(function(t){var n=t.name;switch(e.world.goLoadStep(n),n){case"base":e.ready=!0,e.trigger(T);break;case"final":e.navigation.start(),e.world.model.faces&&e.world.model.faces.on(d,(function(t){e.trigger("face:changed",[t])})),e.world.model.on(M,(function(){e.trigger("modelRotationStarted",[])})),e.world.model.on(C,(function(){e.trigger("modelRotationEnded",[])})),e.trigger(w)}}))}},{key:"_setDepthOfField",value:function(){this.depthOfField=new he(this)}},{key:"_setNavigation",value:function(){var e=this;this.navigation=new we(this),this.navigation.on(v,(function(t){e.trigger(v,[t])}))}}]),o}(p.EventEmitter);var tt="ig-preloader";const nt=function(){function n(i){if(e(this,n),"object"!==t(i.settings))throw new Error("IG.Preloader.constructor : _options.folder must be a settings object.");if(!i.settings.folder||!(0,p.isString)(i.settings.folder))throw new Error("IG.Preloader.constructor : _options.settings.folder has to exists and must be a string. More precisely, it is the name of the folder in which the assets of the preloader in question are located (/preloaders/FOLDER_NAME/).");this._path=F.assetsPath+i.settings.folder,this.tweaks=i.gallery.tweaks,this.$el=(0,p.createEl)("div",i.$target,tt),this.$cont=this._createCont(i.$target,i.settings),this.destroy=this.destroy.bind(this),this._loadFont(),this._setProgress(i.gallery),this._setSpin()}return a(n,[{key:"destroy",value:function(){this.$el.classList.add("disabled"),this.spin&&this.spin.kill(),this.spin=null}},{key:"_createCont",value:function(e,t){var n=this,i="".concat(tt,"_content"),r=(0,p.createEl)("div",this.$el,i),o={debugging:!1,position:{x:.5,y:.5}};return this.tweaks.on(O,(function(e){if(!F.debug){var t=e.preloader;n.$cont.style.left=100*(t?t.preloaderPositionX:o.position.x)+"%",n.$cont.style.top=100*(t?t.preloaderPositionY:o.position.y)+"%"}})),this.tweaks.on(L,(function(){n.tweaks.getTweak({path:"presets.preloader",preset:!1,object:o,objectProperty:"debugging",type:"boolean",default:o.debugging,onChange:function(e){n.$el.classList[e.value?"add":"remove"]("debugging")}}),n.tweaks.getTweak({path:"presets.preloader",object:o.position,objectProperty:"x",presetProperty:"preloaderPositionX",type:"number",min:0,max:1,step:.01,default:o.position.x,apply:function(e){n.$cont.style.left=100*e.value+"%"}}),n.tweaks.getTweak({path:"presets.preloader",object:o.position,objectProperty:"y",presetProperty:"preloaderPositionY",type:"number",min:0,max:1,step:.01,default:o.position.x,apply:function(e){n.$cont.style.top=100*e.value+"%"}})})),r}},{key:"_setSpin",value:function(){var e=this,t=(0,p.createEl)("div",this.$cont,"".concat(tt,"_spinner"));p.lottie.setIDPrefix("PRELOADER");var n=p.lottie.loadAnimation({container:t,renderer:"svg",loop:!0,autoplay:!0,path:this._path+"/spinner.json"}),i=function t(){e.load.bDone&&((0,p.listen)(n,!1,"loopComplete",t),n.stop(),p.gsap.to(e.$cont,{opacity:0,duration:.5,onComplete:e.destroy}))};this.spin={},this.spin.kill=function(){(0,p.listen)(n,!1,"loopComplete",i),n.destroy()},(0,p.listen)(n,!0,"loopComplete",i)}},{key:"_setProgress",value:function(e){var t=this,n=(0,p.createEl)("span",this.$cont,"".concat(tt,"_progress"));this.load={},this.load.bDone=!1,this.load.off=function(){e.off(_,i)};var i=function(e){var i=Math.round(100*e);n.innerHTML=i.toString(),100===i&&(t.load.bDone=!0,t.load.off())};e.on(_,i)}},{key:"_loadFont",value:function(){new FontFace("PreloaderFont","url("+this._path+"/font.woff2)",{style:"normal",weight:400}).load().then((function(e){document.fonts.add(e)})).catch((function(e){console.log("Error when trying loading preloader font."),console.log(e)}))}}]),n}();function it(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return rt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var ot={drag:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40" style="enable-background:new 0 0 40 40" xml:space="preserve"><path d="M20.2 19v-5.2c0-1-.8-1.8-1.8-1.8s-1.8.8-1.8 1.8V27l-3.5-3.8c-.7-.8-2-.9-2.8-.2-.8.7-.9 1.9-.3 2.7l7.7 10.4c2.4 3.3 7 3.9 10.2 1.5 1.9-1.4 3-3.6 3-5.9v-9.4c0-1-.9-1.8-1.8-1.8-1 0-1.7.8-1.8 1.8v-1.5c0-1-.8-1.8-1.8-1.8s-1.8.8-1.8 1.8v-1.5c0-1-.8-1.8-1.8-1.8-.8.1-1.5.7-1.7 1.5z"/><path d="M37.9 14.6c0 .1.1.1.1.1s.1 0 .1-.1l.3-.9c.2-.4.7-.7 1.1-.5.4.2.7.6.5 1.1l-1.6 4.9c-.2.6-.9.9-1.5.7-.2-.1-.4-.2-.5-.3L33 15.9c-.3-.4-.3-.9.1-1.2.3-.3.9-.3 1.2.1l1.2 1.3s.1.1.2 0V16C34.1 7.2 25.7 1.6 17 3.3 10.6 4.5 5.6 9.5 4.4 15.9c0 .1 0 .1.1.1h.1l1.2-1.3c.3-.4.9-.4 1.2-.1s.4.9.1 1.2l-3.4 3.7c-.4.5-1.1.5-1.6.1-.1-.1-.3-.3-.3-.5L.2 14.2c-.1-.5.1-.9.6-1.1.4-.1.9.1 1.1.5l.3.9c0 .1.1.1.1.1s.1 0 .1-.1C4.7 4.8 14.6-1.2 24.5 1.2 31.1 2.8 36.3 8 37.9 14.6z"/></svg>',timer:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 45 40" style="enable-background:new 0 0 45 40" xml:space="preserve"><path d="M24 5.4c-1-.1-2-.1-2.9 0V3.7h-2V1.5c0-.8.6-1.4 1.4-1.4h4.2c.8 0 1.4.6 1.4 1.4v2.2h-2L24 5.4zm14.1 3.2c.5.5.5 1.3.1 1.8l-.6.6-1.5-1.4-.9 1-.9-.9.9-1-1.5-1.4.5-.5c.5-.5 1.3-.5 1.8 0l2.1 1.8z"/><path d="M22.5 40.1c9.4 0 17-7.6 17-17s-7.6-17-17-17-17 7.6-17 17 7.6 17 17 17zm1.4-14.9c-.8.8-2.1.8-2.9 0-.6-.6-.7-1.4-.5-2.2.4-1 1.6-1.6 2.6-1.2.2.1.4.2.6.4l8.8-3.8c.2-.1.5 0 .6.2s0 .5-.2.6l-8.5 4.4v.1c0 .6-.2 1.1-.5 1.5z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>'},at=function(){function t(n){e(this,t),this.gallery=n.gallery,this.$target=n.$target,this.config=Object.assign({backgroundColor:"#FFF",svgColor:"#000",opacity:1,circle:!1},n.config),this.list=[]}return a(t,[{key:"update",value:function(){var e=this.gallery.world;if(e&&e.points){var t,n=it(e.points.items);try{for(n.s();!(t=n.n()).done;){var i=t.value;if("action"===i.type){var r=this._getAction(i.name).element.style;i&&i.visible?(r.transform="translate(".concat(i.screenPosition.style.x,"px, ").concat(i.screenPosition.style.y,"px)"),r.display="block"):r.display="none"}}}catch(e){n.e(e)}finally{n.f()}}this._destroyList()}},{key:"destroy",value:function(){}},{key:"_getAction",value:function(e){var t=this.list.find((function(t){return t.name===e}));return t||((t={}).name=e,t.element=this._createAction(e),this.list.push(t)),t}},{key:"_createAction",value:function(e){var t=this.config,n=(0,p.createEl)("div",this.$target,"ig-action",{"background-color":t.backgroundColor,opacity:t.opacity,fill:t.svgColor},{"data-name":e});if(t.circle&&n.classList.add("ig-action--circle"),t.items&&t.items.length>0){var i=t.items[this.list.length];i&&i.svg&&(n.innerHTML=ot[i.svg])}return n}},{key:"_destroyList",value:function(){var e,t=this,n=it(this.list.filter((function(e){return!t.gallery.world.points.items.find((function(t){return t.name===e.name}))})));try{for(n.s();!(e=n.n()).done;){var i=e.value;this.$target.removeChild(i.element);var r=this.list.indexOf(i);this.list.splice(r,1)}}catch(e){n.e(e)}finally{n.f()}}}]),t}();const st=at;const lt=function(){function t(n){e(this,t),this.gallery=n.gallery,this.$target=n.$target,this.bVisible=!1,this.bMove=!0,this.tween=null,this.orbitPointScale=0,this._$orbitPoint=null,this._setup(n)}return a(t,[{key:"show",value:function(){this.bMove=!0,this._killTween(),this.tween=p.gsap.to(this,{duration:1.25,delay:0,orbitPointScale:1,ease:"power4.inOut"})}},{key:"hide",value:function(){var e=this;this._killTween(),this.tween=p.gsap.to(this,{duration:.75,delay:0,orbitPointScale:0,ease:"power4.inOut",onComplete:function(){e.bMove=!1}})}},{key:"update",value:function(){var e=this.gallery.world;e&&e.orbit&&(e.orbit.point.visible?this.bVisible||(this.show(),this.bVisible=!0):this.bVisible&&(this.hide(),this.bVisible=!1),this.bMove&&(this._$orbitPoint.style.transform="translate(".concat(e.orbit.point.screenPosition.style.x,"px, ").concat(e.orbit.point.screenPosition.style.y,"px) scale(").concat(this.orbitPointScale,")")))}},{key:"destroy",value:function(){}},{key:"_setup",value:function(e){var t=e.$target,n=(e.gallery.tweaks,0),i=(0,p.createEl)("div",t,"ig-action ig-action--circle inactive",{"--border-width":n+"rem","--border-color":"#000"});i.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19 19"><path d="M3.343 10.276v2.029a.222.222 0 0 1-.22.225.229.229 0 0 1-.16-.066L0 9.5l2.96-2.96a.225.225 0 0 1 .38.16v2.237h3.756a.555.555 0 0 1 0 1.11H3.577a.225.225 0 0 0-.234.23Zm5.606 5.38V11.9a.555.555 0 0 1 1.11 0v3.756h2.242a.218.218 0 0 1 .22.226.212.212 0 0 1-.062.154L9.5 19l-2.963-2.963a.221.221 0 0 1 .159-.38h2.254Zm1.106-8.573a.555.555 0 1 1-1.11 0V3.327H6.707a.216.216 0 0 1-.22-.226.213.213 0 0 1 .062-.154L9.499 0l2.964 2.963a.22.22 0 0 1 0 .314.222.222 0 0 1-.162.066h-2.254l.008 3.74Zm5.981-.546L19 9.5l-2.96 2.96a.225.225 0 0 1-.38-.16v-2.236h-3.756a.555.555 0 0 1 0-1.11h3.757V6.698c0-.123.098-.223.22-.225a.23.23 0 0 1 .16.067l-.005-.004Z"/></svg>',this._$orbitPoint=i}},{key:"_killTween",value:function(){this.tween&&this.tween.kill(),this.tween=null}}]),t}();function ct(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ut(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}const ht=function(){function t(n){e(this,t),this.gallery=n.gallery,this.$target=n.$target,(0,p.bind)("_onClick",this),this.list=[]}return a(t,[{key:"getPoint",value:function(e){var t=this.list.find((function(t){return t.name===e}));return t||((t={}).name=e,t.element=(0,p.createEl)("div",this.$target,"ig-point",null,{"data-name":e}),(0,p.listen)(t.element,!0,m,this._onClick),this.list.push(t)),t}},{key:"update",value:function(){if(this.gallery.world&&this.gallery.world.points){var e,t=ct(this.gallery.world.points.items);try{for(t.s();!(e=t.n()).done;){var n=e.value;if("default"===n.type){var i=this.getPoint(n.name).element.style;n&&n.visible?(i.transform="translate(".concat(n.screenPosition.style.x,"px, ").concat(n.screenPosition.style.y,"px)"),i.display="block"):i.display="none"}}}catch(e){t.e(e)}finally{t.f()}}this._destroyList()}},{key:"destroy",value:function(){}},{key:"_onClick",value:function(e){this.gallery.navigation.goPoint(e.currentTarget.dataset.name)}},{key:"_destroyList",value:function(){var e,t=this,n=this.list.filter((function(e){return!t.gallery.world.points.items.find((function(t){return t.name===e.name}))})),i=ct(n);try{for(i.s();!(e=i.n()).done;){var r=e.value;(0,p.listen)(r.element,!1,m,this._onClick),this.$target.removeChild(r.element);var o=this.list.indexOf(r);this.list.splice(o,1)}}catch(e){i.e(e)}finally{i.f()}}}]),t}();function pt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return dt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}const ft=function(){function t(n){e(this,t),this.gallery=n.gallery,(0,p.bind)(["_onClickBack","_onClickThumb"],this);var i=Object.assign({position:"bottom",borderColor:"#C91415",borderFocusColor:"#393939"},n.config);this.$el=(0,p.createEl)("div",n.$target,"ig-thumbnails ig-thumbnails--".concat(i.position),{"--border-color":i.borderColor,"--border-focus-color":i.borderFocusColor}),this.list=[],this._$backEl=null,this.$current=null}return a(t,[{key:"update",value:function(){var e=this.gallery.world;if(e&&e.points){var t,n=pt(e.points.items);try{for(n.s();!(t=n.n()).done;){var i=t.value;"thumbnail"===i.type&&this._getThumb(i.name)}}catch(e){n.e(e)}finally{n.f()}}this._destroyList()}},{key:"resetThumbnails",value:function(){this._$backEl&&this._toggleThumb(this._$backEl)}},{key:"destroy",value:function(){}},{key:"_onClickBack",value:function(){this.gallery.navigation.leavePoint(),this._toggleThumb(this._$backEl)}},{key:"_onClickThumb",value:function(e){var t=e.currentTarget;this.gallery.navigation.goPoint(t.getAttribute("data-name")),this._toggleThumb(t)}},{key:"_getThumb",value:function(e){var t=this.list.find((function(t){return t.name===e}));return t||(this._$backEl||(this._$backEl=this._createThumb("back",this._onClickBack,!0)),(t={}).name=e,t.element=this._createThumb(e,this._onClickThumb),this.list.push(t)),t}},{key:"_createThumb",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=(0,p.createEl)(q,this.$el,"ig-btn ig-thumb",null,{"data-name":e}),o=F.assets.thumbnails;if(o&&o.length>0){var a=i?o[0]:o[this.list.length+1];if(a){a.desktop&&(a=V.isMobileSize||F.emulateMobile?a.mobile:a.desktop);var s=new Image;s.onload=function(){n.$el.style.setProperty("--child-width",s.width/2+"px"),n.$el.style.setProperty("--ratio",s.width/s.height),r.style.background="url(".concat(s.src,")")},s.src=a}}return i&&(r.classList.add("activated"),this.$current=r),(0,p.listen)(r,!0,m,t),r}},{key:"_toggleThumb",value:function(e){this.$current.classList.remove("activated"),e.classList.add("activated"),this.$current=e}},{key:"_destroyList",value:function(){var e,t=this,n=this.list.filter((function(e){return!t.gallery.world.points.items.find((function(t){return t.name===e.name}))})),i=pt(n);try{for(i.s();!(e=i.n()).done;){var r=e.value;(0,p.listen)(r.element,!1,m,this._onClickThumb),this.$el.removeChild(r.element);var o=this.list.indexOf(r);this.list.splice(o,1)}}catch(e){i.e(e)}finally{i.f()}this.list.length<=0&&this._$backEl&&((0,p.listen)(this._$backEl,!1,m,this._onClickBack),this.$el.removeChild(this._$backEl),this._$backEl=null)}}]),t}();var mt=function(){function t(n){e(this,t);var i=n.gallery,r=n.config,o=(0,p.createEl)("div",n.$target,"ig-ui");this._handleKey(),this.points=new ht({gallery:i,$target:o}),this.thumbnails=new ft({gallery:i,$target:o,config:r.thumbnails}),this.actions=new st({gallery:i,$target:o,config:r.actions}),this.orbitPoint=new lt({gallery:i,$target:o})}return a(t,[{key:"update",value:function(){this.points.update(),this.thumbnails.update(),this.actions.update(),this.orbitPoint.update()}},{key:"_handleKey",value:function(e){var t=this;(0,p.listen)(window,!0,y,(function(n){"Escape"===n.code&&(e.navigation.leavePoint(),t.thumbnails.resetThumbnails())}))}}]),t}();const vt=mt;var gt=function(t){c(o,t);var n,i,r=(n=o,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(n);if(i){var r=h(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return u(this,e)});function o(t){var n;if(e(this,o),n=r.call(this),(0,p.isUndef)(t))throw new Error("InteractiveGallery.constructor : _$target must be a string or a Node element");return(0,p.bind)(["render","resize"],s(n)),(t=t instanceof Node?t:(0,p.find)(t)).classList.add("-loading"),n.$el=t,V.init(t),n.time=new B,n.time.on("tick",n.render),n._setGallery(t),n}return a(o,[{key:"setup",value:function(e){var t=this;return F.init(e),F.emulateMobile&&(this.$el.classList.add("emulate-mobile"),V.init(this.$el)),e.preloader&&new nt({$target:this.$el,gallery:this.gallery,settings:e.preloader}),Promise.all([I(this.$el),F.fetch()]).then((function(){V.on(R,t.resize),t.resize()})).then((function(){var n=e.presets;n=n.desktop?V.isMobileSize||F.emulateMobile?n.mobile:n.desktop:n,t.gallery.setup(n)})).then((function(){return t._setUI()}))}},{key:"start",value:function(){this.time.play(),this.bPendingResize&&this.resize()}},{key:"stop",value:function(){this.time.pause()}},{key:"render",value:function(){this.gallery.update(),this.ui&&this.ui.update()}},{key:"resize",value:function(){if(this.time.playing){if(this.bPendingResize=!1,0!==V.width&&0!==V.height&&(this.gallery.resize(),!F.emulateMobile)){var e=window.innerWidth<1024;V.isMobileSize!==e&&location.reload()}}else this.bPendingResize=!0}},{key:"_setGallery",value:function(e){var t=this,n=(0,p.createEl)("div",e,"ig-canvas");this.gallery=new et({$target:n,time:this.time}),this.gallery.on(T,(function(){e.style.opacity=1,t.gallery.navigation.dragControls.on(ve,(function(){return t.trigger("drag_start")}))})),this.gallery.on(w,(function(){return e.classList.remove("-loading")}))}},{key:"_setUI",value:function(){this.ui=new vt({$target:this.$el,gallery:this.gallery,config:{thumbnails:{position:"left"},actions:{items:[{svg:"drag",action:null},{svg:"timer",action:null}]}}})}}]),o}(p.EventEmitter)})(),_interactive_gallery_core=i})(),Object.assign(this.IG,_interactive_gallery_core);